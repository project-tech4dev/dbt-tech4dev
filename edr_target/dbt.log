{"data": {"msg": "Elementary: [{\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.6, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "info", "msg": "Elementary: [{\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.6, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"5a9ffd97-a8d7-449a-87eb-264a35d385b0\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-03 03:33:29\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"d2663b85-1ae3-4e04-b8f5-0423c3eed84d\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-03 20:36:05\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}]", "name": "JinjaLogInfo", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.621810Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.656118Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.457402, "process_in_blocks": "32", "process_kernel_time": 0.217866, "process_mem_max_rss": "165264", "process_out_blocks": "9320", "process_user_time": 6.59122}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 6.457402, \"process_user_time\": 6.59122, \"process_kernel_time\": 0.217866, \"process_mem_max_rss\": \"165264\", \"process_in_blocks\": \"32\", \"process_out_blocks\": \"9320\"}", "name": "ResourceReport", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.665348Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-09T00:01:28.666213Z", "elapsed": 6.4584746, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:28.666213 after 6.46 seconds", "name": "CommandCompleted", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.666347Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.667004Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3d6e651d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3d6e63781d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3d6e57cb680>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3d6e651d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3d6e63781d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3d6e57cb680>]}", "name": "SendingEvent", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.667622Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "9872f6ad-b3a8-4fff-a4b7-534730736d3f", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1078202, "thread": "MainThread", "ts": "2026-02-09T00:01:28.668273Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed33f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed3318710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed29421b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed33f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed3318710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed29421b0>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.422361Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.426227Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_dbt_models_test_coverage\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'json', 'target_path': 'None', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_dbt_models_test_coverage\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.427113Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed2ada4e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed2ada4e0>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.666773Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed296ebd0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed296ebd0>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.731531Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.732719Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:31.825800Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.042434Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.043208Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed1d2e540>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed1d2e540>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.109075Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed1368290>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed1368290>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.294915Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.295864Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed13e4200>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6fab15-c400-4ccb-9213-c973346b0b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed13e4200>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.296677Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.297539Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.298170Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.298840Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.299404Z"}}
{"data": {"elapsed": 0.028490895, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "SQL status: BEGIN in 0.028 seconds", "name": "SQLQueryStatus", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.327987Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.328805Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.329381Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.329955Z"}}
{"data": {"elapsed": 0.000573038, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.331095Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.350822Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.394052Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.394966Z"}}
{"data": {"elapsed": 0.000707034, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.396449Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.397245Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.398011Z"}}
{"data": {"elapsed": 0.004364888, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "SQL status: SELECT 28 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.403169Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, alerts_schema_changes, anomaly_threshold_sensitivity, metrics_anomaly_score, model_run_results, job_run_results, monitors_runs, snapshot_run_results, alerts_dbt_source_freshness, dbt_artifacts_hashes, alerts_anomaly_detection, alerts_dbt_tests, alerts_dbt_models", "name": "ListRelations", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.414787Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.422245Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n            with dbt_tests as (\n                select\n                    parent_model_unique_id,\n                    test_column_name\n                from \"tech4dev\".\"elementary\".\"dbt_tests\"\n            )\n\n            select \n                parent_model_unique_id as model_unique_id,\n                SUM(\n                    case \n                        when test_column_name is not null then 1\n                        else 0\n                        end\n                ) as column_tests,\n                 SUM(\n                    case\n                        when test_column_name is null then 1\n                        else 0\n                        end \n                )as table_tests\n            from dbt_tests\n            group by parent_model_unique_id\n        \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n            with dbt_tests as (\n                select\n                    parent_model_unique_id,\n                    test_column_name\n                from \"tech4dev\".\"elementary\".\"dbt_tests\"\n            )\n\n            select \n                parent_model_unique_id as model_unique_id,\n                SUM(\n                    case \n                        when test_column_name is not null then 1\n                        else 0\n                        end\n                ) as column_tests,\n                 SUM(\n                    case\n                        when test_column_name is null then 1\n                        else 0\n                        end \n                )as table_tests\n            from dbt_tests\n            group by parent_model_unique_id\n        \n  ", "name": "SQLQuery", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.423144Z"}}
{"data": {"elapsed": 0.0021566711, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "SQL status: SELECT 0 in 0.002 seconds", "name": "SQLQueryStatus", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.426044Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.434413Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.435273Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.436682Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.0801195, "process_in_blocks": "0", "process_kernel_time": 0.140805, "process_mem_max_rss": "165264", "process_out_blocks": "3864", "process_user_time": 2.253901}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 1.0801195, \"process_user_time\": 2.253901, \"process_kernel_time\": 0.140805, \"process_mem_max_rss\": \"165264\", \"process_out_blocks\": \"3864\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.445496Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-09T00:01:32.446415Z", "elapsed": 1.0812128, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:32.446415 after 1.08 seconds", "name": "CommandCompleted", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.446543Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.447184Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed2f77e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed13681d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed11e7f80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed2f77e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed13681d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf83ed11e7f80>]}", "name": "SendingEvent", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.447778Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "2c6fab15-c400-4ccb-9213-c973346b0b7b", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1078310, "thread": "MainThread", "ts": "2026-02-09T00:01:32.448390Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff9c6b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dffc1ecef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff9c3e4b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff9c6b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dffc1ecef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff9c3e4b0>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:34.959561Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:34.963267Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_nodes_depends_on_nodes\", \"macro_args\": {\"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'version_check': 'True', 'profiles_dir': 'elementary_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_nodes_depends_on_nodes\", \"macro_args\": {\"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:34.965200Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff970f410>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff970f410>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:35.198072Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dffa34ed80>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dffa34ed80>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:35.260490Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:35.261642Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:35.348126Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:35.497181Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dffa317320>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dffa317320>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:35.497997Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:39.645149Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff8184e30>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff8184e30>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:39.648982Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff7843fe0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff7843fe0>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.007881Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff89e95b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff89e95b0>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.203647Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.204504Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff81769f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117cf5fc-b937-495b-add9-46a313e0243a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff81769f0>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.205175Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.206081Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.206869Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.207457Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.208036Z"}}
{"data": {"elapsed": 0.030258961, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.238387Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.239212Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.239827Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.240415Z"}}
{"data": {"elapsed": 0.0006221039, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.241653Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.260910Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.305462Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.306418Z"}}
{"data": {"elapsed": 0.00070992997, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.307995Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.308919Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.309770Z"}}
{"data": {"elapsed": 0.004364871, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "SQL status: SELECT 28 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.314933Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, alerts_schema_changes, anomaly_threshold_sensitivity, metrics_anomaly_score, model_run_results, job_run_results, monitors_runs, snapshot_run_results, alerts_dbt_source_freshness, dbt_artifacts_hashes, alerts_anomaly_detection, alerts_dbt_tests, alerts_dbt_models", "name": "ListRelations", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.323500Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.331371Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        select\n            unique_id,\n            depends_on_nodes,\n            materialization,\n            'model' as type\n        from \"tech4dev\".\"elementary\".\"dbt_models\"\n        \n            where package_name != 'elementary'\n        \n        union all\n        select\n            unique_id,\n            null as depends_on_nodes,\n            null as materialization,\n            'source' as type\n        from \"tech4dev\".\"elementary\".\"dbt_sources\"\n        union all\n        select\n            unique_id,\n            depends_on_nodes,\n            null as materialization,\n            'exposure' as type\n        from \"tech4dev\".\"elementary\".\"dbt_exposures\"\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        select\n            unique_id,\n            depends_on_nodes,\n            materialization,\n            'model' as type\n        from \"tech4dev\".\"elementary\".\"dbt_models\"\n        \n            where package_name != 'elementary'\n        \n        union all\n        select\n            unique_id,\n            null as depends_on_nodes,\n            null as materialization,\n            'source' as type\n        from \"tech4dev\".\"elementary\".\"dbt_sources\"\n        union all\n        select\n            unique_id,\n            depends_on_nodes,\n            null as materialization,\n            'exposure' as type\n        from \"tech4dev\".\"elementary\".\"dbt_exposures\"\n    \n  ", "name": "SQLQuery", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.332081Z"}}
{"data": {"elapsed": 0.001742474, "query_id": "", "status": "SELECT 61"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "SQL status: SELECT 61 in 0.002 seconds", "name": "SQLQueryStatus", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.334500Z"}}
{"data": {"msg": "Elementary: [{\"unique_id\": \"model.tech4dev.resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_opportunities\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_reports\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.recent_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_recipients\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabResource_Time_Allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\", \\\"source.tech4dev.erp_next.resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabTask\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabMonthly_Digest\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabEmployee\\\", \\\"source.tech4dev.erp_next.tabFocus_Area_Table\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.follower_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.total_follower_count\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.support_issues_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.consulting_time_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.organization_lookup\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_recipients\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_reports\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"depends_on_nodes\": \"[]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_monthly_digest\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_task_hierarchy\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.int_budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabNPS_Survey\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_support_issues\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_consulting_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_linkedin_follower_count\\\", \\\"model.tech4dev.int_linkedin_org_lookup\\\", \\\"model.tech4dev.int_linkedin_share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabMonthly_Digest\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabFocus_Area_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabEmployee\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabTask\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProject\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabResource_Time_Allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.resource_allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.consulting_time_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.support_issues_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_recipients\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_reports\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.recent_campaigns\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.mailing_lists\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.follower_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.share_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.organization_lookup\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.total_follower_count\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.sales_invoice\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.budget_actuals\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabNPS_Survey\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabCustomer\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabOpportunity\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProduct_Type_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "info", "msg": "Elementary: [{\"unique_id\": \"model.tech4dev.resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_opportunities\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_reports\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.recent_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_recipients\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabResource_Time_Allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\", \\\"source.tech4dev.erp_next.resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabTask\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabMonthly_Digest\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabEmployee\\\", \\\"source.tech4dev.erp_next.tabFocus_Area_Table\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.follower_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.total_follower_count\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.support_issues_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.consulting_time_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.organization_lookup\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_recipients\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_reports\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"depends_on_nodes\": \"[]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_monthly_digest\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_task_hierarchy\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.int_budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabNPS_Survey\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_support_issues\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_consulting_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_linkedin_follower_count\\\", \\\"model.tech4dev.int_linkedin_org_lookup\\\", \\\"model.tech4dev.int_linkedin_share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabMonthly_Digest\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabFocus_Area_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabEmployee\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabTask\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProject\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabResource_Time_Allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.resource_allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.consulting_time_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.support_issues_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_recipients\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_reports\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.recent_campaigns\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.mailing_lists\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.follower_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.share_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.organization_lookup\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.total_follower_count\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.sales_invoice\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.budget_actuals\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabNPS_Survey\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabCustomer\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabOpportunity\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProduct_Type_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}]", "name": "JinjaLogInfo", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.347662Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.349189Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.350560Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.450522, "process_in_blocks": "0", "process_kernel_time": 0.204296, "process_mem_max_rss": "165264", "process_out_blocks": "7552", "process_user_time": 6.43281}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.450522, \"process_user_time\": 6.43281, \"process_kernel_time\": 0.204296, \"process_mem_max_rss\": \"165264\", \"process_out_blocks\": \"7552\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.359711Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-09T00:01:40.360548Z", "elapsed": 5.4515896, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:40.360548 after 5.45 seconds", "name": "CommandCompleted", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.360698Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.361334Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff9c6b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff89e9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff8175940>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff9c6b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff89e9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf5dff8175940>]}", "name": "SendingEvent", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.361963Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "117cf5fc-b937-495b-add9-46a313e0243a", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1078361, "thread": "MainThread", "ts": "2026-02-09T00:01:40.362574Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546ead0fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8100140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8034260>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546ead0fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8100140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8034260>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:42.929063Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:42.932765Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocation\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocation\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:42.933598Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7eb39e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7eb39e0>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.185276Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7e18bc0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7e18bc0>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.261505Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.262722Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.373856Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.588774Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.589657Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.590236Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8a83200>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8a83200>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:43.590904Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:47.623691Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7127bf0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7127bf0>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:47.624545Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546ebc793d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546ebc793d0>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:47.961310Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e6b6a450>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e6b6a450>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.148880Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.149757Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e6878890>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58bd2ac0-7d4d-402c-9556-51e7647ffd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e6878890>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.150417Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.151404Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.152055Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.152669Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.153229Z"}}
{"data": {"elapsed": 0.03261896, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "SQL status: BEGIN in 0.033 seconds", "name": "SQLQueryStatus", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.185937Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.186740Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.187340Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.187965Z"}}
{"data": {"elapsed": 0.001169148, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.189758Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.243117Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_run_results as (\n      select *\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select unique_id, invocation_id from latest_run_results\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_run_results as (\n      select *\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select unique_id, invocation_id from latest_run_results\n  \n  ", "name": "SQLQuery", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.243933Z"}}
{"data": {"elapsed": 0.12629694, "query_id": "", "status": "SELECT 66"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "SQL status: SELECT 66 in 0.126 seconds", "name": "SQLQueryStatus", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.370967Z"}}
{"data": {"msg": "Elementary: [{\"unique_id\": \"model.elementary.alerts_anomaly_detection\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_dbt_models\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_dbt_source_freshness\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_dbt_tests\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_schema_changes\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.anomaly_threshold_sensitivity\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.data_monitoring_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_artifacts_hashes\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_columns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_exposures\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_invocations\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_models\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_seeds\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_snapshots\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_source_freshness_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_sources\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_tests\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.elementary_test_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.job_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.metadata\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.metrics_anomaly_score\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.model_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.monitors_runs\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.schema_columns_snapshot\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.snapshot_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.test_result_rows\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "info", "msg": "Elementary: [{\"unique_id\": \"model.elementary.alerts_anomaly_detection\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_dbt_models\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_dbt_source_freshness\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_dbt_tests\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.alerts_schema_changes\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.anomaly_threshold_sensitivity\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.data_monitoring_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_artifacts_hashes\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_columns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_exposures\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_invocations\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_models\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_seeds\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_snapshots\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_source_freshness_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_sources\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.dbt_tests\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.elementary_test_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.job_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.metadata\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.metrics_anomaly_score\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.model_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.monitors_runs\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.schema_columns_snapshot\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.snapshot_run_results\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.elementary.test_result_rows\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\"}]", "name": "JinjaLogInfo", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.383467Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.385035Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.517425, "process_in_blocks": "0", "process_kernel_time": 0.187999, "process_mem_max_rss": "165264", "process_out_blocks": "7528", "process_user_time": 6.376896}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.517425, \"process_user_time\": 6.376896, \"process_kernel_time\": 0.187999, \"process_mem_max_rss\": \"165264\", \"process_out_blocks\": \"7528\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.394623Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-09T00:01:48.395445Z", "elapsed": 5.518465, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:48.395445 after 5.52 seconds", "name": "CommandCompleted", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.395573Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.396277Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e83a8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7158470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8d8ca40>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e83a8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e7158470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf546e8d8ca40>]}", "name": "SendingEvent", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.396896Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "58bd2ac0-7d4d-402c-9556-51e7647ffd27", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1078446, "thread": "MainThread", "ts": "2026-02-09T00:01:48.397498Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd31406d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd315a7c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd31406e030>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd31406d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd315a7c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd31406e030>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.019028Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.022707Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocations_data\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'elementary_profiles', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocations_data\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.023624Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd312f3c8c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd312f3c8c0>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.261653Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd3137904a0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd3137904a0>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.325434Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.326627Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.413916Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.575435Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd311bef200>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd311bef200>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:51.576367Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:55.822951Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd311982ea0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd311982ea0>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:55.823808Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd31198bf20>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd31198bf20>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.156812Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd312249220>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd312249220>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.336513Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.337355Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd3119c8e90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d52c6d-d556-4958-bb75-f5add56e2805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd3119c8e90>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.338106Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.338953Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.339572Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.340159Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.340733Z"}}
{"data": {"elapsed": 0.03155317, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "SQL status: BEGIN in 0.032 seconds", "name": "SQLQueryStatus", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.372376Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.373190Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.373822Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.374397Z"}}
{"data": {"elapsed": 0.000685783, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.375680Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.439169Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.440202Z"}}
{"data": {"elapsed": 0.000729262, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.441575Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.442239Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_invocations'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_invocations'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.442863Z"}}
{"data": {"elapsed": 0.0096457, "query_id": "", "status": "SELECT 35"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "SQL status: SELECT 35 in 0.010 seconds", "name": "SQLQueryStatus", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.453127Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.464694Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_models_invocations as (\n      select distinct invocation_id\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select\n      invocation_id,\n      command,\n      selected,\n      full_refresh,\n      \n        job_url,\n      \n      job_name,\n      job_id,\n      orchestrator\n    from \"tech4dev\".\"elementary\".\"dbt_invocations\" invocations\n    join latest_models_invocations using (invocation_id)\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_models_invocations as (\n      select distinct invocation_id\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select\n      invocation_id,\n      command,\n      selected,\n      full_refresh,\n      \n        job_url,\n      \n      job_name,\n      job_id,\n      orchestrator\n    from \"tech4dev\".\"elementary\".\"dbt_invocations\" invocations\n    join latest_models_invocations using (invocation_id)\n  \n  ", "name": "SQLQuery", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.465407Z"}}
{"data": {"elapsed": 0.12566493, "query_id": "", "status": "SELECT 2"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "SQL status: SELECT 2 in 0.126 seconds", "name": "SQLQueryStatus", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.591810Z"}}
{"data": {"msg": "Elementary: [{\"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"command\": \"run\", \"selected\": \"[]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}, {\"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"command\": \"run\", \"selected\": \"[\\\"tag:dalgo\\\"]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "info", "msg": "Elementary: [{\"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"command\": \"run\", \"selected\": \"[]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}, {\"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"command\": \"run\", \"selected\": \"[\\\"tag:dalgo\\\"]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}]", "name": "JinjaLogInfo", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.601014Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.601902Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.603322Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.644127, "process_in_blocks": "0", "process_kernel_time": 0.199534, "process_mem_max_rss": "165264", "process_out_blocks": "7504", "process_user_time": 6.468173}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.644127, \"process_user_time\": 6.468173, \"process_kernel_time\": 0.199534, \"process_mem_max_rss\": \"165264\", \"process_out_blocks\": \"7504\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.612047Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-09T00:01:56.612857Z", "elapsed": 5.645118, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:56.612857 after 5.65 seconds", "name": "CommandCompleted", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.612982Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.613600Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd313155c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd312248b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd3120075c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd313155c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd312248b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xefd3120075c0>]}", "name": "SendingEvent", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.614193Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "78d52c6d-d556-4958-bb75-f5add56e2805", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1078533, "thread": "MainThread", "ts": "2026-02-09T00:01:56.614811Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd930adc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd92847d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd92ce94f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd930adc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd92847d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd92ce94f0>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:12.722811Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:12.728850Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_latest_invocation\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'fail_fast': 'False', 'profiles_dir': 'elementary_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_latest_invocation\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:12.729867Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd93ee71a0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd93ee71a0>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.103074Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd91d1e8d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd91d1e8d0>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.180903Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.182049Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.313962Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.531836Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.532733Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.533299Z"}}
{"data": {"reason": "a project dependency has been added"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Unable to do partial parsing because a project dependency has been added", "name": "UnableToPartialParse", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.534058Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd929872f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd929872f0>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:13.534726Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:18.543849Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd83d40410>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd83d40410>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:18.544785Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd90a0dd60>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd90a0dd60>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.034164Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd907cfd70>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd907cfd70>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.224943Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.225811Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd907e95e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f000c0e-7127-4e14-8fdf-d92d4f33d437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd907e95e0>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.226523Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.227379Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.228020Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.228620Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.229189Z"}}
{"data": {"elapsed": 0.04173788, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "SQL status: BEGIN in 0.042 seconds", "name": "SQLQueryStatus", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.271020Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.271836Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.272446Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.273054Z"}}
{"data": {"elapsed": 0.000599048, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.274231Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.292908Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.345518Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.346289Z"}}
{"data": {"elapsed": 0.00088130904, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.347830Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.348511Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.349130Z"}}
{"data": {"elapsed": 0.025826361, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "SQL status: SELECT 28 in 0.026 seconds", "name": "SQLQueryStatus", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.375677Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, job_run_results, monitors_runs, metrics_anomaly_score, model_run_results, snapshot_run_results, dbt_artifacts_hashes, alerts_dbt_models, alerts_dbt_source_freshness, alerts_anomaly_detection, alerts_dbt_tests, anomaly_threshold_sensitivity, alerts_schema_changes", "name": "ListRelations", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.382947Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.398020Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    select * from \"tech4dev\".\"elementary\".\"dbt_invocations\" order by generated_at desc limit 1\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    select * from \"tech4dev\".\"elementary\".\"dbt_invocations\" order by generated_at desc limit 1\n  \n  ", "name": "SQLQuery", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.398774Z"}}
{"data": {"elapsed": 0.011403716, "query_id": "", "status": "SELECT 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "SQL status: SELECT 1 in 0.011 seconds", "name": "SQLQueryStatus", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.410890Z"}}
{"data": {"msg": "Elementary: [{\"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"job_id\": null, \"job_name\": null, \"job_run_id\": null, \"run_started_at\": \"2026-02-09 20:36:41\", \"run_completed_at\": \"2026-02-09 20:36:49\", \"generated_at\": \"2026-02-09 20:36:49\", \"created_at\": \"2026-02-09T20:36:49.208770\", \"command\": \"run\", \"dbt_version\": \"1.9.8\", \"elementary_version\": \"0.15.2\", \"full_refresh\": false, \"invocation_vars\": \"{}\", \"vars\": \"{}\", \"target_name\": \"production\", \"target_database\": \"tech4dev\", \"target_schema\": \"production\", \"target_profile_name\": \"tech4dev\", \"threads\": 4, \"selected\": \"[\\\"tag:dalgo\\\"]\", \"yaml_selector\": null, \"project_id\": null, \"project_name\": \"tech4dev\", \"env\": null, \"env_id\": null, \"cause_category\": null, \"cause\": null, \"pull_request_id\": null, \"git_sha\": null, \"orchestrator\": null, \"dbt_user\": null, \"job_url\": null, \"job_run_url\": null, \"account_id\": null, \"target_adapter_specific_fields\": \"{\\\"user\\\": \\\"airbyte\\\"}\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "info", "msg": "Elementary: [{\"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"job_id\": null, \"job_name\": null, \"job_run_id\": null, \"run_started_at\": \"2026-02-09 20:36:41\", \"run_completed_at\": \"2026-02-09 20:36:49\", \"generated_at\": \"2026-02-09 20:36:49\", \"created_at\": \"2026-02-09T20:36:49.208770\", \"command\": \"run\", \"dbt_version\": \"1.9.8\", \"elementary_version\": \"0.15.2\", \"full_refresh\": false, \"invocation_vars\": \"{}\", \"vars\": \"{}\", \"target_name\": \"production\", \"target_database\": \"tech4dev\", \"target_schema\": \"production\", \"target_profile_name\": \"tech4dev\", \"threads\": 4, \"selected\": \"[\\\"tag:dalgo\\\"]\", \"yaml_selector\": null, \"project_id\": null, \"project_name\": \"tech4dev\", \"env\": null, \"env_id\": null, \"cause_category\": null, \"cause\": null, \"pull_request_id\": null, \"git_sha\": null, \"orchestrator\": null, \"dbt_user\": null, \"job_url\": null, \"job_run_url\": null, \"account_id\": null, \"target_adapter_specific_fields\": \"{\\\"user\\\": \\\"airbyte\\\"}\"}]", "name": "JinjaLogInfo", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.422256Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.423242Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.425526Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.7686667, "process_in_blocks": "6576", "process_kernel_time": 0.245313, "process_mem_max_rss": "146848", "process_out_blocks": "7520", "process_user_time": 6.646117}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 6.7686667, \"process_user_time\": 6.646117, \"process_kernel_time\": 0.245313, \"process_mem_max_rss\": \"146848\", \"process_in_blocks\": \"6576\", \"process_out_blocks\": \"7520\"}", "name": "ResourceReport", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.434734Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:00:19.435559Z", "elapsed": 6.7697573, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:00:19.435559 after 6.77 seconds", "name": "CommandCompleted", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.435759Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.436413Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd92ad4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd90af8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd907eb680>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd92ad4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd90af8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfdcd907eb680>]}", "name": "SendingEvent", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.437030Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "3f000c0e-7127-4e14-8fdf-d92d4f33d437", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822400, "thread": "MainThread", "ts": "2026-02-10T00:00:19.437665Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21061df7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21064dc2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf210618094f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21061df7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21064dc2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf210618094f0>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.402253Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.405985Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'version_check': 'True', 'profiles_dir': 'elementary_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_adapter_type_and_unique_id\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.406925Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106411bb90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106411bb90>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.725331Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106128acc0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106128acc0>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.794726Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.796533Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:22.902850Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.149144Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.149981Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106142c2c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106142c2c0>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.226194Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21060276750>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21060276750>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.439501Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.440385Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106070e9c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a614265f-9b3f-422e-aa40-3bfd890c8714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2106070e9c0>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.441096Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.441953Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.442562Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.443149Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.443719Z"}}
{"data": {"elapsed": 0.03005603, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.473873Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.475363Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.476050Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.477293Z"}}
{"data": {"elapsed": 0.0006514131, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.478618Z"}}
{"data": {"msg": "Elementary: [\"postgres\", \"tech4dev-internal.c4hvhyuxrcet.ap-south-1.rds.amazonaws.com\"]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "info", "msg": "Elementary: [\"postgres\", \"tech4dev-internal.c4hvhyuxrcet.ap-south-1.rds.amazonaws.com\"]", "name": "JinjaLogInfo", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.498488Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.499475Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.1874436, "process_in_blocks": "8", "process_kernel_time": 0.153518, "process_mem_max_rss": "146848", "process_out_blocks": "3848", "process_user_time": 2.228968}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 1.1874436, \"process_user_time\": 2.228968, \"process_kernel_time\": 0.153518, \"process_mem_max_rss\": \"146848\", \"process_in_blocks\": \"8\", \"process_out_blocks\": \"3848\"}", "name": "ResourceReport", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.516093Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:00:23.518011Z", "elapsed": 1.1895772, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:00:23.518011 after 1.19 seconds", "name": "CommandCompleted", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.518170Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.519241Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21064dc2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2105fc873e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2105fc87950>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf21064dc2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2105fc873e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf2105fc87950>]}", "name": "SendingEvent", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.520727Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "a614265f-9b3f-422e-aa40-3bfd890c8714", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822513, "thread": "MainThread", "ts": "2026-02-10T00:00:23.521370Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b9f8b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b9f8a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b9ad7e00>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b9f8b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b9f8a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b9ad7e00>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.163515Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.167354Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'profiles_dir': 'elementary_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_elementary_database_and_schema\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'log_format': 'json', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.168234Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8babbfaa0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8babbfaa0>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.414801Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b99ce210>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b99ce210>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.480163Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.481443Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.573723Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.726865Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.727671Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.728264Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8ba5bb350>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8ba5bb350>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:26.728897Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.034545Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b7a76db0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b7a76db0>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.035429Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b84453d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b84453d0>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.369420Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b842deb0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b842deb0>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.571353Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.572240Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b841e1b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b841e1b0>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.572995Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.573920Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.574545Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.575174Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.576642Z"}}
{"data": {"elapsed": 0.032490645, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "SQL status: BEGIN in 0.032 seconds", "name": "SQLQueryStatus", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.609202Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.610102Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.610726Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.611294Z"}}
{"data": {"elapsed": 0.00067490304, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.612564Z"}}
{"data": {"msg": "Elementary: \"tech4dev.elementary\""}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "info", "msg": "Elementary: \"tech4dev.elementary\"", "name": "JinjaLogInfo", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.629074Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.630056Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.526301, "process_in_blocks": "0", "process_kernel_time": 0.186196, "process_mem_max_rss": "146976", "process_out_blocks": "7496", "process_user_time": 6.437361}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.526301, \"process_user_time\": 6.437361, \"process_kernel_time\": 0.186196, \"process_mem_max_rss\": \"146976\", \"process_out_blocks\": \"7496\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.639182Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:00:31.640068Z", "elapsed": 5.527377, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:00:31.640068 after 5.53 seconds", "name": "CommandCompleted", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.640211Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.640851Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b842e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b83fc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b83ff9b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b842e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b83fc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4f8b83ff9b0>]}", "name": "SendingEvent", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.641446Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "ee63bc0f-c37b-4fca-aea1-cdc0632e5cfc", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822543, "thread": "MainThread", "ts": "2026-02-10T00:00:31.642088Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c90263b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902583f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902638470>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c90263b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902583f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902638470>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.517427Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.521185Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_test_results\", \"macro_args\": {\"days_back\": 7, \"invocations_per_test\": 720, \"disable_passed_test_metrics\": false}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_test_results\", \"macro_args\": {\"days_back\": 7, \"invocations_per_test\": 720, \"disable_passed_test_metrics\": false}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.522065Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c90402f260>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c90402f260>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.771024Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9025ee570>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9025ee570>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.834468Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.835644Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:34.949015Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:35.101906Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:35.102709Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:35.103271Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c903067050>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c903067050>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:35.103896Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:39.465809Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9018bd0d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9018bd0d0>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:39.466714Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9011ace00>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9011ace00>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:39.847401Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c900ebb380>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c900ebb380>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.028078Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.029028Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9017140e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aff2dc4-9904-49ff-bfea-fed9d5615654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c9017140e0>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.029711Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.030554Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.031203Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.031797Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.032371Z"}}
{"data": {"elapsed": 0.034239627, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "SQL status: BEGIN in 0.034 seconds", "name": "SQLQueryStatus", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.066732Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.067538Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.068151Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.068831Z"}}
{"data": {"elapsed": 0.001256179, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.070710Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.159376Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with test_results as (\n            \n    with elementary_test_results as (\n        select * from \"tech4dev\".\"elementary\".\"elementary_test_results\"\n        \n            where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(detected_at as timestamp))::date)\n     < 7\n        \n    ),\n\n    dbt_run_results as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_run_results\"\n        \n            where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(execute_completed_at as timestamp))::date)\n     < 7\n        \n    ),\n\n    dbt_tests as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_tests\"\n    ),\n\n    dbt_models as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_models\"\n    ),\n\n    dbt_sources as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_sources\"\n    ),\n\n    dbt_artifacts as (\n        select unique_id, meta, tags, owner from dbt_models\n        union all\n        select unique_id, meta, tags, owner from dbt_sources\n    ),\n\n    first_time_test_occurred as (\n        select \n            min(detected_at) as first_time_occurred,\n            test_unique_id\n        from elementary_test_results\n        group by test_unique_id\n    )\n\n    select\n        elementary_test_results.id,\n        \n        case\n            when elementary_test_results.test_type = 'schema_change' then elementary_test_results.test_unique_id\n            \n            when dbt_tests.short_name = 'dimension_anomalies' then elementary_test_results.test_unique_id\n            else coalesce(elementary_test_results.test_unique_id, 'None') || '.' || coalesce(elementary_test_results.column_name, 'None') || '.' || coalesce(elementary_test_results.test_sub_type, 'None')\n        end as elementary_unique_id,\n        elementary_test_results.invocation_id,\n        elementary_test_results.data_issue_id,\n        elementary_test_results.test_execution_id,\n        elementary_test_results.test_unique_id,\n        elementary_test_results.model_unique_id,\n        elementary_test_results.detected_at,\n        elementary_test_results.database_name,\n        elementary_test_results.schema_name,\n        elementary_test_results.table_name,\n        elementary_test_results.column_name,\n        elementary_test_results.test_type,\n        elementary_test_results.test_sub_type,\n        elementary_test_results.test_results_description,\n        elementary_test_results.owners,\n        elementary_test_results.tags,\n        elementary_test_results.test_results_query,\n        elementary_test_results.other,\n        case\n            when dbt_tests.short_name is not null then dbt_tests.short_name\n            else elementary_test_results.test_name\n        end as test_name,\n        elementary_test_results.test_params,\n        elementary_test_results.severity,\n        elementary_test_results.status,\n        \n        dbt_tests.short_name,\n        elementary_test_results.test_alias,\n        elementary_test_results.failures,\n        elementary_test_results.result_rows,\n        dbt_tests.original_path,\n        dbt_tests.meta,\n        dbt_tests.package_name,\n        dbt_tests.tags as test_tags,\n        dbt_artifacts.meta as model_meta,\n        dbt_artifacts.tags as model_tags,\n        dbt_artifacts.owner as model_owner,\n        first_occurred.first_time_occurred as test_created_at,\n        dbt_run_results.execution_time as execution_time\n    from elementary_test_results\n    join dbt_tests on elementary_test_results.test_unique_id = dbt_tests.unique_id\n    left join first_time_test_occurred first_occurred on elementary_test_results.test_unique_id = first_occurred.test_unique_id\n    left join dbt_artifacts on elementary_test_results.model_unique_id = dbt_artifacts.unique_id\n    left join dbt_run_results on elementary_test_results.test_execution_id = dbt_run_results.model_execution_id\n\n        ),\n\n        ordered_test_results as (\n            select\n                *,\n                \n        ((\n    current_timestamp::timestamp\n)::date - (cast(detected_at as timestamp))::date)\n     as days_diff,\n                \n                rank() over (partition by elementary_unique_id order by detected_at desc) as invocations_rank_index\n            from test_results\n        )\n\n        select \n            id,\n            invocation_id,\n            test_execution_id,\n            model_unique_id,\n            test_unique_id,\n            elementary_unique_id,\n            detected_at,\n            database_name,\n            schema_name,\n            table_name,\n            column_name,\n            test_type,\n            test_sub_type,\n            test_results_description,\n            original_path,\n            package_name,\n            owners,\n            model_owner,\n            tags,\n            test_tags,\n            model_tags,\n            meta,\n            model_meta,\n            test_results_query,\n            other,\n            test_name,\n            test_params,\n            severity,\n            status,\n            execution_time,\n            days_diff,\n            invocations_rank_index,\n            failures,\n            result_rows\n        from ordered_test_results\n        where invocations_rank_index <= 720\n        order by elementary_unique_id, invocations_rank_index desc\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with test_results as (\n            \n    with elementary_test_results as (\n        select * from \"tech4dev\".\"elementary\".\"elementary_test_results\"\n        \n            where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(detected_at as timestamp))::date)\n     < 7\n        \n    ),\n\n    dbt_run_results as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_run_results\"\n        \n            where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(execute_completed_at as timestamp))::date)\n     < 7\n        \n    ),\n\n    dbt_tests as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_tests\"\n    ),\n\n    dbt_models as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_models\"\n    ),\n\n    dbt_sources as (\n        select * from \"tech4dev\".\"elementary\".\"dbt_sources\"\n    ),\n\n    dbt_artifacts as (\n        select unique_id, meta, tags, owner from dbt_models\n        union all\n        select unique_id, meta, tags, owner from dbt_sources\n    ),\n\n    first_time_test_occurred as (\n        select \n            min(detected_at) as first_time_occurred,\n            test_unique_id\n        from elementary_test_results\n        group by test_unique_id\n    )\n\n    select\n        elementary_test_results.id,\n        \n        case\n            when elementary_test_results.test_type = 'schema_change' then elementary_test_results.test_unique_id\n            \n            when dbt_tests.short_name = 'dimension_anomalies' then elementary_test_results.test_unique_id\n            else coalesce(elementary_test_results.test_unique_id, 'None') || '.' || coalesce(elementary_test_results.column_name, 'None') || '.' || coalesce(elementary_test_results.test_sub_type, 'None')\n        end as elementary_unique_id,\n        elementary_test_results.invocation_id,\n        elementary_test_results.data_issue_id,\n        elementary_test_results.test_execution_id,\n        elementary_test_results.test_unique_id,\n        elementary_test_results.model_unique_id,\n        elementary_test_results.detected_at,\n        elementary_test_results.database_name,\n        elementary_test_results.schema_name,\n        elementary_test_results.table_name,\n        elementary_test_results.column_name,\n        elementary_test_results.test_type,\n        elementary_test_results.test_sub_type,\n        elementary_test_results.test_results_description,\n        elementary_test_results.owners,\n        elementary_test_results.tags,\n        elementary_test_results.test_results_query,\n        elementary_test_results.other,\n        case\n            when dbt_tests.short_name is not null then dbt_tests.short_name\n            else elementary_test_results.test_name\n        end as test_name,\n        elementary_test_results.test_params,\n        elementary_test_results.severity,\n        elementary_test_results.status,\n        \n        dbt_tests.short_name,\n        elementary_test_results.test_alias,\n        elementary_test_results.failures,\n        elementary_test_results.result_rows,\n        dbt_tests.original_path,\n        dbt_tests.meta,\n        dbt_tests.package_name,\n        dbt_tests.tags as test_tags,\n        dbt_artifacts.meta as model_meta,\n        dbt_artifacts.tags as model_tags,\n        dbt_artifacts.owner as model_owner,\n        first_occurred.first_time_occurred as test_created_at,\n        dbt_run_results.execution_time as execution_time\n    from elementary_test_results\n    join dbt_tests on elementary_test_results.test_unique_id = dbt_tests.unique_id\n    left join first_time_test_occurred first_occurred on elementary_test_results.test_unique_id = first_occurred.test_unique_id\n    left join dbt_artifacts on elementary_test_results.model_unique_id = dbt_artifacts.unique_id\n    left join dbt_run_results on elementary_test_results.test_execution_id = dbt_run_results.model_execution_id\n\n        ),\n\n        ordered_test_results as (\n            select\n                *,\n                \n        ((\n    current_timestamp::timestamp\n)::date - (cast(detected_at as timestamp))::date)\n     as days_diff,\n                \n                rank() over (partition by elementary_unique_id order by detected_at desc) as invocations_rank_index\n            from test_results\n        )\n\n        select \n            id,\n            invocation_id,\n            test_execution_id,\n            model_unique_id,\n            test_unique_id,\n            elementary_unique_id,\n            detected_at,\n            database_name,\n            schema_name,\n            table_name,\n            column_name,\n            test_type,\n            test_sub_type,\n            test_results_description,\n            original_path,\n            package_name,\n            owners,\n            model_owner,\n            tags,\n            test_tags,\n            model_tags,\n            meta,\n            model_meta,\n            test_results_query,\n            other,\n            test_name,\n            test_params,\n            severity,\n            status,\n            execution_time,\n            days_diff,\n            invocations_rank_index,\n            failures,\n            result_rows\n        from ordered_test_results\n        where invocations_rank_index <= 720\n        order by elementary_unique_id, invocations_rank_index desc\n  ", "name": "SQLQuery", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.160494Z"}}
{"data": {"elapsed": 0.011826635, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "SQL status: SELECT 0 in 0.012 seconds", "name": "SQLQueryStatus", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.173417Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.181534Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n  select\n    elementary_test_results_id,\n    result_row\n  from \"tech4dev\".\"elementary\".\"test_result_rows\"\n  where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(detected_at as timestamp))::date)\n     < 7\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n  select\n    elementary_test_results_id,\n    result_row\n  from \"tech4dev\".\"elementary\".\"test_result_rows\"\n  where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(detected_at as timestamp))::date)\n     < 7\n  \n  ", "name": "SQLQuery", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.182284Z"}}
{"data": {"elapsed": 0.16315314, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "SQL status: SELECT 0 in 0.163 seconds", "name": "SQLQueryStatus", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.346163Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.357278Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.358188Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.9077444, "process_in_blocks": "0", "process_kernel_time": 0.230707, "process_mem_max_rss": "159796", "process_out_blocks": "7528", "process_user_time": 6.53807}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.9077444, \"process_user_time\": 6.53807, \"process_kernel_time\": 0.230707, \"process_mem_max_rss\": \"159796\", \"process_out_blocks\": \"7528\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.370634Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:00:40.371462Z", "elapsed": 5.9087944, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:00:40.371462 after 5.91 seconds", "name": "CommandCompleted", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.371610Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.372265Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c900eb8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902617e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902614530>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c900eb8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902617e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf4c902614530>]}", "name": "SendingEvent", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.372881Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "5aff2dc4-9904-49ff-bfea-fed9d5615654", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822653, "thread": "MainThread", "ts": "2026-02-10T00:00:40.373490Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd48aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd488260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd48ad20>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd48aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd488260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd48ad20>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.208044Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.212025Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_source_freshness_results\", \"macro_args\": {\"days_back\": 7, \"invocations_per_test\": 720}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_source_freshness_results\", \"macro_args\": {\"days_back\": 7, \"invocations_per_test\": 720}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.212908Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd419d30>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd419d30>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.463699Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd7dcda0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd7dcda0>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.532955Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.534172Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.641839Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.869965Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.870742Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd2ca780>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd2ca780>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:43.938703Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dc035820>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dc035820>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.159971Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.160881Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dbe85220>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c32d0c-154d-43a3-b973-b50759a8ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dbe85220>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.161539Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.162499Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.163124Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.163704Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.164349Z"}}
{"data": {"elapsed": 0.029631935, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.194071Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.194865Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.195437Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.196028Z"}}
{"data": {"elapsed": 0.00067074294, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.197291Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.288660Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.289509Z"}}
{"data": {"elapsed": 0.00074226595, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.290941Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.291632Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_source_freshness_results'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_source_freshness_results'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.292263Z"}}
{"data": {"elapsed": 0.010726088, "query_id": "", "status": "SELECT 17"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "SQL status: SELECT 17 in 0.011 seconds", "name": "SQLQueryStatus", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.303740Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.313805Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_sources'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_sources'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.314524Z"}}
{"data": {"elapsed": 0.00437827, "query_id": "", "status": "SELECT 22"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "SQL status: SELECT 22 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.320268Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.362024Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with dbt_source_freshness_results as (\n            select\n                *,\n                \n    case\n        when status = 'error' then 'fail'\n        when status = 'runtime error' then 'error'\n        else status\n    end as normalized_status\n,\n                rank() over (partition by unique_id order by generated_at desc) as invocations_rank_index\n            from \"tech4dev\".\"elementary\".\"dbt_source_freshness_results\"\n            \n                where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(generated_at as timestamp))::date)\n     < 7\n            \n        ),\n\n        dbt_sources as (\n            select * from \"tech4dev\".\"elementary\".\"dbt_sources\"\n        )\n\n        select\n            freshness.source_freshness_execution_id,\n            freshness.unique_id,\n            freshness.max_loaded_at,\n            freshness.generated_at,\n            freshness.status as original_status,\n            freshness.normalized_status,\n            \n            \n                freshness.error_after,\n                freshness.warn_after,\n                freshness.filter,\n            \n            freshness.max_loaded_at_time_ago_in_s,\n            freshness.snapshotted_at,\n            freshness.invocation_id,\n            freshness.error,\n            freshness.invocations_rank_index,\n            sources.database_name,\n            sources.schema_name,\n            sources.source_name,\n            sources.name as table_name,\n            sources.loaded_at_field,\n            sources.meta,\n            sources.tags,\n            sources.owner as owners,\n            sources.freshness_error_after as source_freshness_error_after,\n            sources.freshness_warn_after as source_freshness_warn_after,\n            sources.freshness_filter as source_freshness_filter,\n            sources.relation_name,\n            \n            \n                sources.freshness_description\n            \n        from dbt_source_freshness_results freshness\n        join dbt_sources sources on freshness.unique_id = sources.unique_id\n        where invocations_rank_index <= 720\n        order by freshness.unique_id, invocations_rank_index desc\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with dbt_source_freshness_results as (\n            select\n                *,\n                \n    case\n        when status = 'error' then 'fail'\n        when status = 'runtime error' then 'error'\n        else status\n    end as normalized_status\n,\n                rank() over (partition by unique_id order by generated_at desc) as invocations_rank_index\n            from \"tech4dev\".\"elementary\".\"dbt_source_freshness_results\"\n            \n                where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(generated_at as timestamp))::date)\n     < 7\n            \n        ),\n\n        dbt_sources as (\n            select * from \"tech4dev\".\"elementary\".\"dbt_sources\"\n        )\n\n        select\n            freshness.source_freshness_execution_id,\n            freshness.unique_id,\n            freshness.max_loaded_at,\n            freshness.generated_at,\n            freshness.status as original_status,\n            freshness.normalized_status,\n            \n            \n                freshness.error_after,\n                freshness.warn_after,\n                freshness.filter,\n            \n            freshness.max_loaded_at_time_ago_in_s,\n            freshness.snapshotted_at,\n            freshness.invocation_id,\n            freshness.error,\n            freshness.invocations_rank_index,\n            sources.database_name,\n            sources.schema_name,\n            sources.source_name,\n            sources.name as table_name,\n            sources.loaded_at_field,\n            sources.meta,\n            sources.tags,\n            sources.owner as owners,\n            sources.freshness_error_after as source_freshness_error_after,\n            sources.freshness_warn_after as source_freshness_warn_after,\n            sources.freshness_filter as source_freshness_filter,\n            sources.relation_name,\n            \n            \n                sources.freshness_description\n            \n        from dbt_source_freshness_results freshness\n        join dbt_sources sources on freshness.unique_id = sources.unique_id\n        where invocations_rank_index <= 720\n        order by freshness.unique_id, invocations_rank_index desc\n    \n  ", "name": "SQLQuery", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.362924Z"}}
{"data": {"elapsed": 0.0039842892, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "SQL status: SELECT 0 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.367795Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.377968Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.378999Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.380405Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.2332069, "process_in_blocks": "0", "process_kernel_time": 0.181081, "process_mem_max_rss": "159796", "process_out_blocks": "3880", "process_user_time": 2.301583}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 1.2332069, \"process_user_time\": 2.301583, \"process_kernel_time\": 0.181081, \"process_mem_max_rss\": \"159796\", \"process_out_blocks\": \"3880\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.389918Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:00:44.391909Z", "elapsed": 1.235399, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:00:44.391909 after 1.24 seconds", "name": "CommandCompleted", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.392054Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.393886Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd41bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dbce3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3ddf763c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dd41bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3dbce3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf0e3ddf763c0>]}", "name": "SendingEvent", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.394566Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "c6c32d0c-154d-43a3-b973-b50759a8ce3c", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822742, "thread": "MainThread", "ts": "2026-02-10T00:00:44.395223Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079b0803b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0798d8e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079941eff0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079b0803b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0798d8e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079941eff0>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.095645Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.099510Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models\", \"macro_args\": {\"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'fail_fast': 'False', 'profiles_dir': 'elementary_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models\", \"macro_args\": {\"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'log_format': 'json', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.100406Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0799979400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0799979400>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.339299Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07999cc740>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07999cc740>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.403422Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.404661Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.522939Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.691440Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.692276Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.692870Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07991a72f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07991a72f0>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:47.693489Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:51.939446Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07965ddee0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07965ddee0>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:51.940367Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07965dd8e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07965dd8e0>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.314543Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079783c710>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079783c710>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.491753Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.492609Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07978845c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26ff1d8b-2e4c-460a-b113-970eefde3619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec07978845c0>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.493428Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.494324Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.494973Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.495539Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.496113Z"}}
{"data": {"elapsed": 0.030863224, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "SQL status: BEGIN in 0.031 seconds", "name": "SQLQueryStatus", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.527077Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.527936Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.528618Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.529247Z"}}
{"data": {"elapsed": 0.00060390506, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.530552Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.549461Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.594233Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.595210Z"}}
{"data": {"elapsed": 0.0007241579, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.596786Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.597557Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.598404Z"}}
{"data": {"elapsed": 0.004338853, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "SQL status: SELECT 28 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.603563Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, job_run_results, monitors_runs, metrics_anomaly_score, model_run_results, snapshot_run_results, dbt_artifacts_hashes, alerts_dbt_models, alerts_dbt_source_freshness, alerts_anomaly_detection, alerts_dbt_tests, anomaly_threshold_sensitivity, alerts_schema_changes", "name": "ListRelations", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.612127Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.630097Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_models'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_models'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.630877Z"}}
{"data": {"elapsed": 0.00751988, "query_id": "", "status": "SELECT 19"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "SQL status: SELECT 19 in 0.008 seconds", "name": "SQLQueryStatus", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.639064Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.649795Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n              with dbt_artifacts_models as (\n                select\n                  name,\n                  unique_id,\n                  database_name,\n                  schema_name,\n                  case when alias is not null then alias\n                  else name end as table_name,\n                  owner as owners,\n                  tags,\n                  package_name,\n                  description,\n                  materialization,\n                  \n                  \n                    patch_path,\n                  \n                  original_path as full_path\n                from \"tech4dev\".\"elementary\".\"dbt_models\"\n                \n                  where package_name != 'elementary'\n                \n              )\n\n             select * from dbt_artifacts_models\n        \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n              with dbt_artifacts_models as (\n                select\n                  name,\n                  unique_id,\n                  database_name,\n                  schema_name,\n                  case when alias is not null then alias\n                  else name end as table_name,\n                  owner as owners,\n                  tags,\n                  package_name,\n                  description,\n                  materialization,\n                  \n                  \n                    patch_path,\n                  \n                  original_path as full_path\n                from \"tech4dev\".\"elementary\".\"dbt_models\"\n                \n                  where package_name != 'elementary'\n                \n              )\n\n             select * from dbt_artifacts_models\n        \n  ", "name": "SQLQuery", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.650518Z"}}
{"data": {"elapsed": 0.0016208349, "query_id": "", "status": "SELECT 38"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "SQL status: SELECT 38 in 0.002 seconds", "name": "SQLQueryStatus", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.652810Z"}}
{"data": {"msg": "Elementary: [{\"name\": \"resource_allocation\", \"unique_id\": \"model.tech4dev.resource_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"resource_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/resource_allocation.sql\"}, {\"name\": \"resource_time_allocation\", \"unique_id\": \"model.tech4dev.resource_time_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"resource_time_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"The \\\"resource_time_allocation\\\" table provides a detailed overview of resource time allocations, including unique identifiers, employee details, department information, and time-based metrics such as total and balance hours, capacity, and allocation periods.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/resource_time_allocation.sql\"}, {\"name\": \"opportunities\", \"unique_id\": \"model.tech4dev.opportunities\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"opportunities\", \"owners\": \"[]\", \"tags\": \"[\\\"opportunities\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/opportunities.sql\"}, {\"name\": \"int_campaign_reports\", \"unique_id\": \"model.tech4dev.int_campaign_reports\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_campaign_reports\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_campaign_reports.sql\"}, {\"name\": \"int_campaigns\", \"unique_id\": \"model.tech4dev.int_campaigns\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_campaigns\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_campaigns.sql\"}, {\"name\": \"int_mailing_lists\", \"unique_id\": \"model.tech4dev.int_mailing_lists\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_mailing_lists\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_mailing_lists.sql\"}, {\"name\": \"int_campaign_recipients\", \"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_campaign_recipients\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_campaign_recipients.sql\"}, {\"name\": \"int_resource_time_allocation\", \"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_resource_time_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"The \\\"int_resource_time_allocation\\\" table provides a detailed overview of resource time allocations, including unique identifiers, employee details, department information, and time-based metrics such as total and balance hours, capacity, and allocation periods.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_resource_time_allocation.sql\"}, {\"name\": \"int_sales_invoice\", \"unique_id\": \"model.tech4dev.int_sales_invoice\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_sales_invoice\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_sales_invoice.sql\"}, {\"name\": \"int_resource_allocation\", \"unique_id\": \"model.tech4dev.int_resource_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_resource_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_resource_allocation.sql\"}, {\"name\": \"int_task_hierarchy\", \"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_task_hierarchy\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"A table containing hierarchical task data with details such as task name, subject, current status, associated project name, parent task, and task path information.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_task_hierarchy.sql\"}, {\"name\": \"int_tasks\", \"unique_id\": \"model.tech4dev.int_tasks\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_tasks\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"A table containing project tasks with details such as unique task identifier, task subject/title, current status, associated project, and parent task information.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_tasks.sql\"}, {\"name\": \"int_monthly_digest\", \"unique_id\": \"model.tech4dev.int_monthly_digest\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_monthly_digest\", \"owners\": \"[]\", \"tags\": \"[\\\"digests\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_monthly_digest.sql\"}, {\"name\": \"int_projects\", \"unique_id\": \"model.tech4dev.int_projects\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_projects\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"This table contains information on projects, including their unique identifiers, current status, and expected timelines.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_projects.sql\"}, {\"name\": \"int_budget_actuals\", \"unique_id\": \"model.tech4dev.int_budget_actuals\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_budget_actuals\", \"owners\": \"[]\", \"tags\": \"[\\\"financials\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_budget_actuals.sql\"}, {\"name\": \"int_linkedin_share_statistics\", \"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_share_statistics\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_share_statistics.sql\"}, {\"name\": \"int_linkedin_follower_statistics\", \"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_follower_statistics\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_follower_statistics.sql\"}, {\"name\": \"int_linkedin_follower_count\", \"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_follower_count\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_follower_count.sql\"}, {\"name\": \"int_support_issues\", \"unique_id\": \"model.tech4dev.int_support_issues\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_support_issues\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_support_issues.sql\"}, {\"name\": \"int_consulting_tracker\", \"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_consulting_tracker\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_consulting_tracker.sql\"}, {\"name\": \"int_linkedin_org_lookup\", \"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_org_lookup\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_org_lookup.sql\"}, {\"name\": \"newsletter_contact_summary\", \"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"newsletter_contact_summary\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/zoho/zoho.yml\", \"full_path\": \"models/production/zoho/newsletter_contact_summary.sql\"}, {\"name\": \"campaign_metrics_per_newsletter\", \"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"campaign_metrics_per_newsletter\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/zoho/zoho.yml\", \"full_path\": \"models/production/zoho/campaign_metrics_per_newsletter.sql\"}, {\"name\": \"mailing_lists\", \"unique_id\": \"model.tech4dev.mailing_lists\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"mailing_lists\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/zoho/zoho.yml\", \"full_path\": \"models/production/zoho/mailing_lists.sql\"}, {\"name\": \"calendar\", \"unique_id\": \"model.tech4dev.calendar\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"calendar\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/common/common.yml\", \"full_path\": \"models/production/common/calendar.sql\"}, {\"name\": \"monthly_digest\", \"unique_id\": \"model.tech4dev.monthly_digest\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"monthly_digest\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/monthly_digest.sql\"}, {\"name\": \"task_hierarchy\", \"unique_id\": \"model.tech4dev.task_hierarchy\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"task_hierarchy\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"A table containing hierarchical task data with levels indicating the structure of tasks, their current status, associated project, and a float representing task completion.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/task_hierarchy.sql\"}, {\"name\": \"projects\", \"unique_id\": \"model.tech4dev.projects\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"projects\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"This table contains information on projects, including their unique identifiers, current status, and expected timelines, such as start and end dates.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/projects.sql\"}, {\"name\": \"resource_allocation_metrics\", \"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"resource_allocation_metrics\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"The \\\"resource_allocation_metrics\\\" table provides monthly metrics on resource allocation, including start and end dates, department and employee details, utilized hours, balance hours, total capacity, utilization percentages, and departmental aggregates.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/resource_allocation_metrics.sql\"}, {\"name\": \"kpi_opportunities\", \"unique_id\": \"model.tech4dev.kpi_opportunities\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_opportunities\", \"owners\": \"[]\", \"tags\": \"[\\\"opportunities\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_opportunities.sql\"}, {\"name\": \"kpi_financials\", \"unique_id\": \"model.tech4dev.kpi_financials\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_financials\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_financials.sql\"}, {\"name\": \"kpi_nps_survey\", \"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_nps_survey\", \"owners\": \"[]\", \"tags\": \"[\\\"nps\\\", \\\"survey\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_nps_survey.sql\"}, {\"name\": \"kpi_projects\", \"unique_id\": \"model.tech4dev.kpi_projects\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_projects\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_projects.sql\"}, {\"name\": \"support_issues\", \"unique_id\": \"model.tech4dev.support_issues\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"support_issues\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/dalgo/dalgo.yml\", \"full_path\": \"models/production/dalgo/support_issues.sql\"}, {\"name\": \"consulting_tracker\", \"unique_id\": \"model.tech4dev.consulting_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"consulting_tracker\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/dalgo/dalgo.yml\", \"full_path\": \"models/production/dalgo/consulting_tracker.sql\"}, {\"name\": \"linkedin_stats\", \"unique_id\": \"model.tech4dev.linkedin_stats\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"linkedin_stats\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/dalgo/dalgo.yml\", \"full_path\": \"models/production/dalgo/linkedin_stats.sql\"}, {\"name\": \"int_opportunities\", \"unique_id\": \"model.tech4dev.int_opportunities\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_opportunities\", \"owners\": \"[]\", \"tags\": \"[\\\"opportunities\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_opportunities.sql\"}, {\"name\": \"sales_invoice\", \"unique_id\": \"model.tech4dev.sales_invoice\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"sales_invoice\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/sales_invoice.sql\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "info", "msg": "Elementary: [{\"name\": \"resource_allocation\", \"unique_id\": \"model.tech4dev.resource_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"resource_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/resource_allocation.sql\"}, {\"name\": \"resource_time_allocation\", \"unique_id\": \"model.tech4dev.resource_time_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"resource_time_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"The \\\"resource_time_allocation\\\" table provides a detailed overview of resource time allocations, including unique identifiers, employee details, department information, and time-based metrics such as total and balance hours, capacity, and allocation periods.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/resource_time_allocation.sql\"}, {\"name\": \"opportunities\", \"unique_id\": \"model.tech4dev.opportunities\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"opportunities\", \"owners\": \"[]\", \"tags\": \"[\\\"opportunities\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/opportunities.sql\"}, {\"name\": \"int_campaign_reports\", \"unique_id\": \"model.tech4dev.int_campaign_reports\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_campaign_reports\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_campaign_reports.sql\"}, {\"name\": \"int_campaigns\", \"unique_id\": \"model.tech4dev.int_campaigns\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_campaigns\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_campaigns.sql\"}, {\"name\": \"int_mailing_lists\", \"unique_id\": \"model.tech4dev.int_mailing_lists\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_mailing_lists\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_mailing_lists.sql\"}, {\"name\": \"int_campaign_recipients\", \"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_campaign_recipients\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/zoho/zoho.yml\", \"full_path\": \"models/intermediate/zoho/int_campaign_recipients.sql\"}, {\"name\": \"int_resource_time_allocation\", \"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_resource_time_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"The \\\"int_resource_time_allocation\\\" table provides a detailed overview of resource time allocations, including unique identifiers, employee details, department information, and time-based metrics such as total and balance hours, capacity, and allocation periods.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_resource_time_allocation.sql\"}, {\"name\": \"int_sales_invoice\", \"unique_id\": \"model.tech4dev.int_sales_invoice\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_sales_invoice\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_sales_invoice.sql\"}, {\"name\": \"int_resource_allocation\", \"unique_id\": \"model.tech4dev.int_resource_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_resource_allocation\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_resource_allocation.sql\"}, {\"name\": \"int_task_hierarchy\", \"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_task_hierarchy\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"A table containing hierarchical task data with details such as task name, subject, current status, associated project name, parent task, and task path information.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_task_hierarchy.sql\"}, {\"name\": \"int_tasks\", \"unique_id\": \"model.tech4dev.int_tasks\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_tasks\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"A table containing project tasks with details such as unique task identifier, task subject/title, current status, associated project, and parent task information.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_tasks.sql\"}, {\"name\": \"int_monthly_digest\", \"unique_id\": \"model.tech4dev.int_monthly_digest\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_monthly_digest\", \"owners\": \"[]\", \"tags\": \"[\\\"digests\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_monthly_digest.sql\"}, {\"name\": \"int_projects\", \"unique_id\": \"model.tech4dev.int_projects\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_projects\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"This table contains information on projects, including their unique identifiers, current status, and expected timelines.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_projects.sql\"}, {\"name\": \"int_budget_actuals\", \"unique_id\": \"model.tech4dev.int_budget_actuals\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_budget_actuals\", \"owners\": \"[]\", \"tags\": \"[\\\"financials\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_budget_actuals.sql\"}, {\"name\": \"int_linkedin_share_statistics\", \"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_share_statistics\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_share_statistics.sql\"}, {\"name\": \"int_linkedin_follower_statistics\", \"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_follower_statistics\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_follower_statistics.sql\"}, {\"name\": \"int_linkedin_follower_count\", \"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_follower_count\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_follower_count.sql\"}, {\"name\": \"int_support_issues\", \"unique_id\": \"model.tech4dev.int_support_issues\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_support_issues\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_support_issues.sql\"}, {\"name\": \"int_consulting_tracker\", \"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_consulting_tracker\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_consulting_tracker.sql\"}, {\"name\": \"int_linkedin_org_lookup\", \"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_linkedin_org_lookup\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/dalgo/dalgo.yml\", \"full_path\": \"models/intermediate/dalgo/int_linkedin_org_lookup.sql\"}, {\"name\": \"newsletter_contact_summary\", \"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"newsletter_contact_summary\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/zoho/zoho.yml\", \"full_path\": \"models/production/zoho/newsletter_contact_summary.sql\"}, {\"name\": \"campaign_metrics_per_newsletter\", \"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"campaign_metrics_per_newsletter\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/zoho/zoho.yml\", \"full_path\": \"models/production/zoho/campaign_metrics_per_newsletter.sql\"}, {\"name\": \"mailing_lists\", \"unique_id\": \"model.tech4dev.mailing_lists\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"mailing_lists\", \"owners\": \"[]\", \"tags\": \"[\\\"campaigns\\\", \\\"zoho\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/zoho/zoho.yml\", \"full_path\": \"models/production/zoho/mailing_lists.sql\"}, {\"name\": \"calendar\", \"unique_id\": \"model.tech4dev.calendar\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"calendar\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/common/common.yml\", \"full_path\": \"models/production/common/calendar.sql\"}, {\"name\": \"monthly_digest\", \"unique_id\": \"model.tech4dev.monthly_digest\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"monthly_digest\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/monthly_digest.sql\"}, {\"name\": \"task_hierarchy\", \"unique_id\": \"model.tech4dev.task_hierarchy\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"task_hierarchy\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"A table containing hierarchical task data with levels indicating the structure of tasks, their current status, associated project, and a float representing task completion.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/task_hierarchy.sql\"}, {\"name\": \"projects\", \"unique_id\": \"model.tech4dev.projects\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"projects\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"This table contains information on projects, including their unique identifiers, current status, and expected timelines, such as start and end dates.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/projects.sql\"}, {\"name\": \"resource_allocation_metrics\", \"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"resource_allocation_metrics\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"The \\\"resource_allocation_metrics\\\" table provides monthly metrics on resource allocation, including start and end dates, department and employee details, utilized hours, balance hours, total capacity, utilization percentages, and departmental aggregates.\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/resource_allocation_metrics.sql\"}, {\"name\": \"kpi_opportunities\", \"unique_id\": \"model.tech4dev.kpi_opportunities\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_opportunities\", \"owners\": \"[]\", \"tags\": \"[\\\"opportunities\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_opportunities.sql\"}, {\"name\": \"kpi_financials\", \"unique_id\": \"model.tech4dev.kpi_financials\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_financials\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_financials.sql\"}, {\"name\": \"kpi_nps_survey\", \"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_nps_survey\", \"owners\": \"[]\", \"tags\": \"[\\\"nps\\\", \\\"survey\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_nps_survey.sql\"}, {\"name\": \"kpi_projects\", \"unique_id\": \"model.tech4dev.kpi_projects\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"kpi_projects\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/aggregated/aggregated.yml\", \"full_path\": \"models/production/erp-common/aggregated/kpi_projects.sql\"}, {\"name\": \"support_issues\", \"unique_id\": \"model.tech4dev.support_issues\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"support_issues\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/dalgo/dalgo.yml\", \"full_path\": \"models/production/dalgo/support_issues.sql\"}, {\"name\": \"consulting_tracker\", \"unique_id\": \"model.tech4dev.consulting_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"consulting_tracker\", \"owners\": \"[]\", \"tags\": \"[\\\"consulting\\\", \\\"dalgo\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/dalgo/dalgo.yml\", \"full_path\": \"models/production/dalgo/consulting_tracker.sql\"}, {\"name\": \"linkedin_stats\", \"unique_id\": \"model.tech4dev.linkedin_stats\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"linkedin_stats\", \"owners\": \"[]\", \"tags\": \"[\\\"dalgo\\\", \\\"linkedin\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/dalgo/dalgo.yml\", \"full_path\": \"models/production/dalgo/linkedin_stats.sql\"}, {\"name\": \"int_opportunities\", \"unique_id\": \"model.tech4dev.int_opportunities\", \"database_name\": \"tech4dev\", \"schema_name\": \"intermediate\", \"table_name\": \"int_opportunities\", \"owners\": \"[]\", \"tags\": \"[\\\"opportunities\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/intermediate/erp-common/erp-common.yml\", \"full_path\": \"models/intermediate/erp-common/int_opportunities.sql\"}, {\"name\": \"sales_invoice\", \"unique_id\": \"model.tech4dev.sales_invoice\", \"database_name\": \"tech4dev\", \"schema_name\": \"production\", \"table_name\": \"sales_invoice\", \"owners\": \"[]\", \"tags\": \"[\\\"projects\\\"]\", \"package_name\": \"tech4dev\", \"description\": \"\", \"materialization\": \"table\", \"patch_path\": \"tech4dev://models/production/erp-common/erp-common.yml\", \"full_path\": \"models/production/erp-common/sales_invoice.sql\"}]", "name": "JinjaLogInfo", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.668871Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.670941Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.672249Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.637894, "process_in_blocks": "0", "process_kernel_time": 0.22078, "process_mem_max_rss": "159924", "process_out_blocks": "7600", "process_user_time": 6.528663}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.637894, \"process_user_time\": 6.528663, \"process_kernel_time\": 0.22078, \"process_mem_max_rss\": \"159924\", \"process_out_blocks\": \"7600\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.681181Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:00:52.682012Z", "elapsed": 5.6389313, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:00:52.682012 after 5.64 seconds", "name": "CommandCompleted", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.682142Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.682817Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079a01d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0797017f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0797853380>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec079a01d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0797017f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xec0797853380>]}", "name": "SendingEvent", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.683410Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "26ff1d8b-2e4c-460a-b113-970eefde3619", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822795, "thread": "MainThread", "ts": "2026-02-10T00:00:52.684077Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67883bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67238680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67883620>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67883bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67238680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67883620>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.359954Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.363708Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_sources\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_sources\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'log_format': 'json', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.364653Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae66f27920>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae66f27920>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.625208Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67f77650>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae67f77650>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.696675Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.698352Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.801469Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.971710Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.972517Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.973107Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae678e7200>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae678e7200>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:00:55.973741Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.218642Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae64ffd220>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae64ffd220>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.219475Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae6500cd40>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae6500cd40>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.548170Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65f7e330>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65f7e330>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.739085Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.739927Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65f8c050>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81010d44-7627-45fc-b55f-500430c29891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65f8c050>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.740572Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.741405Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.742945Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.743525Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.744105Z"}}
{"data": {"elapsed": 0.031159187, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "SQL status: BEGIN in 0.031 seconds", "name": "SQLQueryStatus", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.775360Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.776174Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.776814Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.777378Z"}}
{"data": {"elapsed": 0.000663219, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.778651Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.798178Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.845544Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.846481Z"}}
{"data": {"elapsed": 0.00087519595, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.848173Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.849032Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.849877Z"}}
{"data": {"elapsed": 0.00433905, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "SQL status: SELECT 28 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.855057Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, job_run_results, monitors_runs, metrics_anomaly_score, model_run_results, snapshot_run_results, dbt_artifacts_hashes, alerts_dbt_models, alerts_dbt_source_freshness, alerts_anomaly_detection, alerts_dbt_tests, anomaly_threshold_sensitivity, alerts_schema_changes", "name": "ListRelations", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.864499Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.872163Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n            with dbt_artifacts_sources as (\n                select\n                  name,\n                  source_name,\n                  unique_id,\n                  database_name,\n                  schema_name,\n                  identifier as table_name,\n                  owner as owners,\n                  tags,\n                  package_name,\n                  description,\n                  original_path as full_path\n                from \"tech4dev\".\"elementary\".\"dbt_sources\"\n              )\n\n            select * from dbt_artifacts_sources\n        \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n            with dbt_artifacts_sources as (\n                select\n                  name,\n                  source_name,\n                  unique_id,\n                  database_name,\n                  schema_name,\n                  identifier as table_name,\n                  owner as owners,\n                  tags,\n                  package_name,\n                  description,\n                  original_path as full_path\n                from \"tech4dev\".\"elementary\".\"dbt_sources\"\n              )\n\n            select * from dbt_artifacts_sources\n        \n  ", "name": "SQLQuery", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.872991Z"}}
{"data": {"elapsed": 0.001239433, "query_id": "", "status": "SELECT 23"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "SQL status: SELECT 23 in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.874897Z"}}
{"data": {"msg": "Elementary: [{\"name\": \"tabMonthly_Digest\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabMonthly_Digest\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabMonthly_Digest\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Project tasks\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabFocus_Area_Table\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabFocus_Area_Table\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabFocus_Area_Table\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Focus Areas of a project\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabEmployee\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabEmployee\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabEmployee\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Employee details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabTask\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabTask\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabTask\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Project tasks\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabProject\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabProject\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabProject\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Projects\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabResource_Time_Allocation\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabResource_Time_Allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabResource_Time_Allocation\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Resource Time Allocation\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"resource_allocation\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.resource_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabHours_Allocation_Table\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Resource Hours Allocation by project and employee\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"consulting_time_tracker\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.consulting_time_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"consulting_time_tracker\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains breakdown of dalgo consulting work\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"support_issues_tracker\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.support_issues_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"support_issues_tracker\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains details on support issues raised by dalgo clients\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"campaign_recipients\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.campaign_recipients\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"campaign_recipients\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains all the sent campaign emails and recipients\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"campaign_reports\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.campaign_reports\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"campaign_reports\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains stats on sent out campaign emails\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"recent_campaigns\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.recent_campaigns\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"recent_campaigns\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains campaign details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"mailing_lists\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.mailing_lists\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"mailing_lists\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains all the mailing lists for T4D\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"follower_statistics\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.follower_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"follower_statistics\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Linkedin Follower Statistics - segment wise breakdown\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"share_statistics\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.share_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"share_statistics\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Linkedin share statistics\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"organization_lookup\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.organization_lookup\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"organization_lookup\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Linkedin Organization Details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"total_follower_count\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.total_follower_count\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"total_follower_count\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Total Follower Count on Linked in\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"sales_invoice\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.sales_invoice\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabSales_Invoice\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Sales Invoices\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"budget_actuals\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.budget_actuals\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"budget_actuals\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Revenue and expense actuals vs targets\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabNPS_Survey\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabNPS_Survey\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabNPS_Survey\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"NPS survey results\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabCustomer\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabCustomer\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabCustomer\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Customer details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabOpportunity\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabOpportunity\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabOpportunity\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Opportunity details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabProduct_Type_Table\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabProduct_Type_Table\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabProduct_Type_Table\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Product types available for leads, opportunities, and projects\", \"full_path\": \"models/schema.yml\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "info", "msg": "Elementary: [{\"name\": \"tabMonthly_Digest\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabMonthly_Digest\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabMonthly_Digest\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Project tasks\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabFocus_Area_Table\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabFocus_Area_Table\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabFocus_Area_Table\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Focus Areas of a project\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabEmployee\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabEmployee\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabEmployee\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Employee details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabTask\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabTask\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabTask\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Project tasks\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabProject\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabProject\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabProject\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Projects\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabResource_Time_Allocation\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabResource_Time_Allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabResource_Time_Allocation\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Resource Time Allocation\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"resource_allocation\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.resource_allocation\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabHours_Allocation_Table\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Resource Hours Allocation by project and employee\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"consulting_time_tracker\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.consulting_time_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"consulting_time_tracker\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains breakdown of dalgo consulting work\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"support_issues_tracker\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.support_issues_tracker\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"support_issues_tracker\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains details on support issues raised by dalgo clients\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"campaign_recipients\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.campaign_recipients\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"campaign_recipients\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains all the sent campaign emails and recipients\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"campaign_reports\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.campaign_reports\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"campaign_reports\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains stats on sent out campaign emails\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"recent_campaigns\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.recent_campaigns\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"recent_campaigns\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains campaign details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"mailing_lists\", \"source_name\": \"staging_zoho\", \"unique_id\": \"source.tech4dev.staging_zoho.mailing_lists\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_zoho\", \"table_name\": \"mailing_lists\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Contains all the mailing lists for T4D\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"follower_statistics\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.follower_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"follower_statistics\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Linkedin Follower Statistics - segment wise breakdown\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"share_statistics\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.share_statistics\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"share_statistics\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Linkedin share statistics\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"organization_lookup\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.organization_lookup\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"organization_lookup\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Linkedin Organization Details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"total_follower_count\", \"source_name\": \"staging_dalgo\", \"unique_id\": \"source.tech4dev.staging_dalgo.total_follower_count\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging_dalgo\", \"table_name\": \"total_follower_count\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Total Follower Count on Linked in\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"sales_invoice\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.sales_invoice\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabSales_Invoice\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Sales Invoices\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"budget_actuals\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.budget_actuals\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"budget_actuals\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Revenue and expense actuals vs targets\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabNPS_Survey\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabNPS_Survey\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabNPS_Survey\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"NPS survey results\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabCustomer\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabCustomer\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabCustomer\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Customer details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabOpportunity\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabOpportunity\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabOpportunity\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Opportunity details\", \"full_path\": \"models/schema.yml\"}, {\"name\": \"tabProduct_Type_Table\", \"source_name\": \"erp_next\", \"unique_id\": \"source.tech4dev.erp_next.tabProduct_Type_Table\", \"database_name\": \"tech4dev\", \"schema_name\": \"staging\", \"table_name\": \"tabProduct_Type_Table\", \"owners\": \"[]\", \"tags\": \"[]\", \"package_name\": \"tech4dev\", \"description\": \"Product types available for leads, opportunities, and projects\", \"full_path\": \"models/schema.yml\"}]", "name": "JinjaLogInfo", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.887740Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.889213Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.890658Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.594539, "process_in_blocks": "0", "process_kernel_time": 0.18409, "process_mem_max_rss": "160180", "process_out_blocks": "7552", "process_user_time": 6.539725}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.594539, \"process_user_time\": 6.539725, \"process_kernel_time\": 0.18409, \"process_mem_max_rss\": \"160180\", \"process_out_blocks\": \"7552\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.900993Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:00.901839Z", "elapsed": 5.59559, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:00.901839 after 5.60 seconds", "name": "CommandCompleted", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.901973Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.902615Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae66eeaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65f7c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65fb46e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae66eeaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65f7c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe8ae65fb46e0>]}", "name": "SendingEvent", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.903220Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "81010d44-7627-45fc-b55f-500430c29891", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822883, "thread": "MainThread", "ts": "2026-02-10T00:01:00.903867Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe06083e1d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe060815ef830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe060815ec140>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe06083e1d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe060815ef830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe060815ec140>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:03.690790Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:03.694612Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_exposures\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_exposures\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:03.695523Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe060808a8b90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe060808a8b90>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:03.935917Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe06083adf9e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe06083adf9e0>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:03.999673Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.001891Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.098779Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.318641Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.319409Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0608094ca70>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0608094ca70>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.384660Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0607ffccfe0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0607ffccfe0>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.583763Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.584614Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe06080880290>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da1be451-c873-4294-b06b-f4265cbfa37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe06080880290>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.585384Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.586260Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.586958Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.587560Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.588141Z"}}
{"data": {"elapsed": 0.030497648, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.618754Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.619541Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.620148Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.620750Z"}}
{"data": {"elapsed": 0.00064609596, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.621975Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.651156Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.701077Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.702053Z"}}
{"data": {"elapsed": 0.00077988696, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.705496Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.706353Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.707133Z"}}
{"data": {"elapsed": 0.004426171, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: SELECT 28 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.712377Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, job_run_results, monitors_runs, metrics_anomaly_score, model_run_results, snapshot_run_results, dbt_artifacts_hashes, alerts_dbt_models, alerts_dbt_source_freshness, alerts_anomaly_detection, alerts_dbt_tests, anomaly_threshold_sensitivity, alerts_schema_changes", "name": "ListRelations", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.723082Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.743730Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_exposures'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_exposures'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.744480Z"}}
{"data": {"elapsed": 0.0078009022, "query_id": "", "status": "SELECT 20"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: SELECT 20 in 0.008 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.752966Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.761254Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_exposures'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_exposures'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.761992Z"}}
{"data": {"elapsed": 0.0041696, "query_id": "", "status": "SELECT 20"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: SELECT 20 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.766843Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.772420Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_exposures'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_exposures'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.773097Z"}}
{"data": {"elapsed": 0.003811181, "query_id": "", "status": "SELECT 20"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: SELECT 20 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.777552Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.787538Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n              with dbt_artifacts_exposures as (\n                select\n                  name,\n                  \n                    label,\n                  \n                  unique_id,\n                  url,\n                  type,\n                  maturity,\n                  owner_email,\n                  owner_name as owners,\n                  tags,\n                  package_name,\n                  description,\n                  meta,\n                  original_path as full_path,\n                  \n                    raw_queries,\n                  \n                  depends_on_nodes,\n                  \n                    depends_on_columns\n                  \n\n                from \"tech4dev\".\"elementary\".\"dbt_exposures\"\n              )\n\n             select * from dbt_artifacts_exposures\n        \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n              with dbt_artifacts_exposures as (\n                select\n                  name,\n                  \n                    label,\n                  \n                  unique_id,\n                  url,\n                  type,\n                  maturity,\n                  owner_email,\n                  owner_name as owners,\n                  tags,\n                  package_name,\n                  description,\n                  meta,\n                  original_path as full_path,\n                  \n                    raw_queries,\n                  \n                  depends_on_nodes,\n                  \n                    depends_on_columns\n                  \n\n                from \"tech4dev\".\"elementary\".\"dbt_exposures\"\n              )\n\n             select * from dbt_artifacts_exposures\n        \n  ", "name": "SQLQuery", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.788302Z"}}
{"data": {"elapsed": 0.001913705, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "SQL status: SELECT 0 in 0.002 seconds", "name": "SQLQueryStatus", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.790914Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.799873Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.800668Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.802039Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.1751305, "process_in_blocks": "0", "process_kernel_time": 0.165715, "process_mem_max_rss": "160180", "process_out_blocks": "3880", "process_user_time": 2.303951}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 1.1751305, \"process_user_time\": 2.303951, \"process_kernel_time\": 0.165715, \"process_mem_max_rss\": \"160180\", \"process_out_blocks\": \"3880\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.813672Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:04.814545Z", "elapsed": 1.1762314, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:04.814545 after 1.18 seconds", "name": "CommandCompleted", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.815244Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.815955Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0608157fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0607fe4b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0608155f740>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0608157fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0607fe4b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe0608155f740>]}", "name": "SendingEvent", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.816571Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "da1be451-c873-4294-b06b-f4265cbfa37a", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1822964, "thread": "MainThread", "ts": "2026-02-10T00:01:04.817265Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda288230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdac82000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdac82d20>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda288230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdac82000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdac82d20>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.401327Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.405128Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_singular_tests\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'json', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_singular_tests\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.406047Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda11f410>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda11f410>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.644258Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda55d100>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda55d100>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.708022Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.709212Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.813833Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.971734Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.972611Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.973192Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdacb70b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdacb70b0>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:07.974037Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.333884Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd81b9040>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd81b9040>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.334790Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd93d8560>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd93d8560>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.676700Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd8b23170>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd8b23170>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.854616Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.855526Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd81cc8c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c49d59a2-f7aa-45c8-a7bd-23725f074ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd81cc8c0>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.856283Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.857144Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.857780Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.858358Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.858943Z"}}
{"data": {"elapsed": 0.029881056, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.888922Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.889760Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.890363Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.890954Z"}}
{"data": {"elapsed": 0.000613809, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.892147Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.941095Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        select\n          unique_id,\n          name,\n          original_path,\n          package_name,\n          tags\n        from \"tech4dev\".\"elementary\".\"dbt_tests\"\n        where type = 'singular'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        select\n          unique_id,\n          name,\n          original_path,\n          package_name,\n          tags\n        from \"tech4dev\".\"elementary\".\"dbt_tests\"\n        where type = 'singular'\n    \n  ", "name": "SQLQuery", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.941898Z"}}
{"data": {"elapsed": 0.001779651, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "SQL status: SELECT 0 in 0.002 seconds", "name": "SQLQueryStatus", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.944315Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.952479Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.953331Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.6127186, "process_in_blocks": "0", "process_kernel_time": 0.193341, "process_mem_max_rss": "160180", "process_out_blocks": "7496", "process_user_time": 6.491627}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.6127186, \"process_user_time\": 6.491627, \"process_kernel_time\": 0.193341, \"process_mem_max_rss\": \"160180\", \"process_out_blocks\": \"7496\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.962165Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:12.962977Z", "elapsed": 5.613722, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:12.962977 after 5.61 seconds", "name": "CommandCompleted", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.963106Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.963752Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdbe15e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd9366ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda55ce60>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cdbe15e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cd9366ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfd0cda55ce60>]}", "name": "SendingEvent", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.964363Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "c49d59a2-f7aa-45c8-a7bd-23725f074ea6", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1823012, "thread": "MainThread", "ts": "2026-02-10T00:01:12.964994Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf31520610d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151e733c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151e733e00>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf31520610d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151e733c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151e733e00>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:15.626380Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:15.630211Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_runs\", \"macro_args\": {\"days_back\": 7, \"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_runs\", \"macro_args\": {\"days_back\": 7, \"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'log_format': 'json', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:15.631205Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151e7cdfa0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151e7cdfa0>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:15.885076Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151f05a930>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151f05a930>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:15.950654Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:15.951860Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:16.057337Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:16.226911Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:16.227777Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:16.228362Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151f21af90>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151f21af90>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:16.229037Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:20.617681Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d0aa480>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d0aa480>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:20.618604Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d166db0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d166db0>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:20.957369Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d074470>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d074470>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.137211Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.138079Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151c6b0110>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e826c8-8b70-4d60-b956-2567343cab08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151c6b0110>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.138727Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.139552Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.140310Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.140932Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.141496Z"}}
{"data": {"elapsed": 0.030279623, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.171872Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.172710Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.173298Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.173909Z"}}
{"data": {"elapsed": 0.000608369, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.175098Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.232655Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with model_runs as (\n            select * from \"tech4dev\".\"elementary\".\"model_run_results\"\n        )\n\n        select\n            unique_id, \n            invocation_id,\n            name,\n            schema_name as schema,\n            status,\n            case\n                when status != 'success' then 0\n                else round(cast(execution_time as numeric(28,6)), 1)\n            end as execution_time,\n            full_refresh,\n            materialization,\n            compiled_code,\n            generated_at\n        from model_runs\n        where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(generated_at as timestamp))::date)\n     < 7\n        \n          and unique_id not like 'model.elementary.%'\n        \n        order by generated_at\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        with model_runs as (\n            select * from \"tech4dev\".\"elementary\".\"model_run_results\"\n        )\n\n        select\n            unique_id, \n            invocation_id,\n            name,\n            schema_name as schema,\n            status,\n            case\n                when status != 'success' then 0\n                else round(cast(execution_time as numeric(28,6)), 1)\n            end as execution_time,\n            full_refresh,\n            materialization,\n            compiled_code,\n            generated_at\n        from model_runs\n        where \n        ((\n    current_timestamp::timestamp\n)::date - (cast(generated_at as timestamp))::date)\n     < 7\n        \n          and unique_id not like 'model.elementary.%'\n        \n        order by generated_at\n    \n  ", "name": "SQLQuery", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.233478Z"}}
{"data": {"elapsed": 0.6130232, "query_id": "", "status": "SELECT 282"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "SQL status: SELECT 282 in 0.613 seconds", "name": "SQLQueryStatus", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.847366Z"}}
{"data": {"msg": "Elementary: [{\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-09 02:37:05\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-09 02:37:05\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "info", "msg": "Elementary: [{\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"af2b36e5-0b74-4ba0-b4a2-30f77bbbe86c\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-04 02:37:08\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a0c8f333-2a4f-4420-aa22-c6f6e1f10065\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-04 20:36:10\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"5c327e97-c0e4-4894-bd7e-a2eb8f576179\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-05 02:35:23\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"fa568fdb-bcbc-4981-a298-676b1d89f709\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-05 20:35:46\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"966525e0-0914-4cd9-91f6-6933ae17529e\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-06 02:35:50\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"1eaa6181-340b-4997-a99a-607d2f441ec6\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-06 20:35:55\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.9, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"dd9fb7fa-32fb-415a-9a00-af0a24416346\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-07 02:37:14\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a325145c-826b-4e58-bd7a-63ae62474e26\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-07 20:36:20\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"bb9b07a3-2a12-452b-a325-36fa8444d502\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 02:37:12\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"cde7b11d-5f77-4d36-ac08-d5e29b643c5f\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-08 20:41:15\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"calendar\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\n\\n\\n-- RECURSIVE CTE TO GENERATE QUARTERS (financial year from April)\\nWITH RECURSIVE quarters AS (\\n    SELECT \\n        DATE '2022-04-01' AS start_date,\\n        (DATE '2022-04-01' + INTERVAL '3 months' - INTERVAL '1 day')::date AS end_date\\n    UNION ALL\\n    SELECT \\n        (start_date + INTERVAL '3 months')::date,\\n        (start_date + INTERVAL '6 months' - INTERVAL '1 day')::date\\n    FROM quarters\\n    WHERE (start_date + INTERVAL '3 months')::date <= DATE '2030-03-31'\\n),\\n\\n-- ADD FINANCIAL YEAR AND LABEL\\nquarter_calendar AS (\\n    SELECT\\n        start_date,\\n        end_date,\\n        'quarter' AS period_type,\\n        \\n        -- Determine financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_year_label,\\n\\n        -- Determine quarter in financial year\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END AS financial_quarter,\\n\\n        -- Combined label\\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) IN (4,5,6) THEN 'Q1'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (7,8,9) THEN 'Q2'\\n            WHEN EXTRACT(MONTH FROM start_date) IN (10,11,12) THEN 'Q3'\\n            ELSE 'Q4'\\n        END \\n        || ' ' || \\n        CASE \\n            WHEN EXTRACT(MONTH FROM start_date) >= 4 \\n                THEN 'FY' || RIGHT((EXTRACT(YEAR FROM start_date))::text, 2)\\n            ELSE 'FY' || RIGHT((EXTRACT(YEAR FROM start_date)-1)::text, 2)\\n        END AS financial_label\\n    FROM quarters\\n),\\n\\n-- FINANCIAL YEAR ROLLUP\\nfinancial_years AS (\\n    SELECT\\n        MIN(start_date) AS start_date,\\n        MAX(end_date) AS end_date,\\n        'year' AS period_type,\\n        financial_year_label AS financial_label\\n    FROM quarter_calendar\\n    GROUP BY financial_year_label\\n)\\n\\n-- UNION QUARTERS AND YEARS\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM quarter_calendar\\n\\nUNION ALL\\n\\nSELECT \\n    start_date,\\n    end_date,\\n    period_type,\\n    financial_label,\\n    ROW_NUMBER() OVER (ORDER BY start_date) AS sort_order\\nFROM financial_years\\n\\nORDER BY start_date\", \"generated_at\": \"2026-02-09 02:37:05\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_budget_actuals\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith unpivoted as (\\n\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q1_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q1_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q2_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q2_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q3_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q3_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy23' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy23\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy24' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy24\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    union all\\n    select\\n        item,\\n        product_type,\\n        _airbyte_raw_id,\\n        _airbyte_extracted_at,\\n        _airbyte_meta,\\n\\n      cast('q4_fy25' as TEXT) as raw_financial_label,\\n      cast(  \\n           q4_fy25\\n             \\n           as text) as raw_amount\\n\\n    from tech4dev.staging.\\\"budget_actuals\\\"\\n\\n    \\n\\n),\\n\\nfinal as (\\n\\n    select\\n        item,\\n        product_type,\\n        -- Transform 'q1_fy22' to 'Q1 FY22'\\n        upper(replace(raw_financial_label, '_', ' ')) as financial_label,\\n        cast(replace(raw_amount, ',', '') as numeric) as amount\\n    from unpivoted\\n\\n)\\n\\nselect * from final\", \"generated_at\": \"2026-02-09 02:37:05\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_campaigns\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_key,\\n    campaign_name,\\n    subject,\\n    from_email,\\n    campaign_status,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    CASE\\n        when lower(from_email) like '%dalgo%' then 'Dalgo'\\n        when lower(from_email) like '%glific%' then 'Glific'\\n        when lower(from_email) like '%fcxo%' then 'FCXO'\\n        when lower(from_email) like '%t4d%'  then 'T4D'\\n        else 'Other'\\n    END as org\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"recent_campaigns\\\"\\nWHERE campaign_status = 'Sent'\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_campaign_recipients\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.8, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    contactemailaddress,\\n    contactid,\\n    cast(sent_time as bigint) as sent_time_ms,\\n    to_timestamp(cast(sent_time as bigint)/1000) at time zone 'Asia/Kolkata' as sent_time,\\n    count(*) over (partition by contactid) as contact_campaigns\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_recipients\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_opportunities\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    o.name,\\n    o.title,\\n    o.opportunity_type,\\n    o.status,\\n    o.custom_opp_owner as opportunity_owner,\\n    o.custom_conversion_date::date as conversion_date,\\n    o.creation::date as creation_date,\\n    o.creation as creation_timestamp,\\n    ptt.product_type as product_type\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n    on ptt.parent = o.name\\n\\nwhere o.creation is not null\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_projects\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    p.name,\\n    p.project_name,\\n    p.custom_product as product_type,\\n    p.custom_contract_status as contract_status,\\n    p.status,\\n    e.employee_name as owner,\\n    p.expected_start_date,\\n    p.expected_end_date,\\n    to_char(p.expected_start_date, 'DD-MM-YYYY') as expected_start_date_text,\\n    to_char(p.expected_end_date, 'DD-MM-YYYY') as expected_end_date_text,\\n    string_agg(f.focus_areas, ', ') as focus_areas\\n\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\" p\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabEmployee\\\" e\\n    on p.custom_project_owner = e.name\\nleft join \\\"tech4dev\\\".\\\"staging\\\".\\\"tabFocus_Area_Table\\\" f\\n    on f.parent = p.name\\n\\ngroup by\\n    p.name,\\n    p.project_name,\\n    p.custom_product,\\n    p.custom_contract_status,\\n    p.status,\\n    e.employee_name,\\n    p.expected_start_date,\\n    p.expected_end_date\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_monthly_digest\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH source AS (\\n    SELECT\\n        *\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabMonthly_Digest\\\"\\n        -- raw table\\n),\\nprojects AS (\\n    SELECT\\n        name,\\n        project_name,\\n        status\\n    FROM\\n        \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProject\\\"\\n)\\nSELECT\\n    s.project,\\n    p.project_name,\\n    p.status,\\n    s.product_type,\\n    s.MONTH,\\n    s.YEAR,\\n    s.hours_spend,\\n    s.hours_committed,\\n    s.highlights,\\n    s.challenges,\\n    s.unplanned_work,\\n    s.plan_next_month,\\n    s.lessons_learned,\\n    s.last_edited_time,\\n    s.creation_time,\\n    MAKE_DATE(\\n        s.YEAR::INTEGER,\\n        CASE s.MONTH\\n            WHEN 'Jan' THEN 1\\n            WHEN 'Feb' THEN 2\\n            WHEN 'Mar' THEN 3\\n            WHEN 'Apr' THEN 4\\n            WHEN 'May' THEN 5\\n            WHEN 'Jun' THEN 6\\n            WHEN 'Jul' THEN 7\\n            WHEN 'Aug' THEN 8\\n            WHEN 'Sep' THEN 9\\n            WHEN 'Oct' THEN 10\\n            WHEN 'Nov' THEN 11\\n            WHEN 'Dec' THEN 12\\n        END,\\n        1\\n    ) AS report_date\\nFROM\\n    source s\\n    LEFT JOIN projects p ON s.project = p.name\\nWHERE\\n    /* removing submitted row logic as doctype has been fixed\\n    COALESCE(s.docstatus, 0) = 1 -- keep only \\u201csubmitted\\u201d rows\\n    AND */\\n    s.YEAR > 2020\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_nps_survey\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- NPS scores calculation (recommend_program: 1-5 scale)\\n-- NPS = (% of promoters - % of detractors) * 100\\n-- Promoters: score 5, Neutrals: score 3-4, Detractors: score 1-2\\nnps_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END) AS promoters,\\n        COUNT(CASE WHEN nps.recommend_program BETWEEN 3 AND 4 THEN 1 END) AS neutrals,\\n        COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END) AS detractors,\\n        ROUND(\\n            ((COUNT(CASE WHEN nps.recommend_program = 5 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100) -\\n            (COUNT(CASE WHEN nps.recommend_program <= 2 THEN 1 END)::NUMERIC / COUNT(*)::NUMERIC * 100))::NUMERIC,\\n            2\\n        ) AS nps_score\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.recommend_program IS NOT NULL\\n      AND nps.recommend_program BETWEEN 1 AND 5\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n),\\n\\n-- Average scores for all other columns (1-5 scale)\\naverage_scores AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        COUNT(*) AS total_responses,\\n        ROUND(AVG(nps.program_outreach::NUMERIC), 2) AS avg_program_outreach,\\n        ROUND(AVG(nps.internal_capacity::NUMERIC), 2) AS avg_internal_capacity,\\n        ROUND(AVG(nps.confident_leverage::NUMERIC), 2) AS avg_confident_leverage,\\n        ROUND(AVG(nps.improved_efficiency::NUMERIC), 2) AS avg_improved_efficiency,\\n        ROUND(AVG(nps.technology_innovation::NUMERIC), 2) AS avg_technology_innovation,\\n        ROUND(AVG(nps.satisfaction_value_add::NUMERIC), 2) AS avg_satisfaction_value_add\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabNPS_Survey\\\" nps\\n      ON nps.form_filled_date::date BETWEEN cal.start_date AND cal.end_date\\n    WHERE nps.program_outreach IS NOT NULL\\n      OR nps.internal_capacity IS NOT NULL\\n      OR nps.confident_leverage IS NOT NULL\\n      OR nps.improved_efficiency IS NOT NULL\\n      OR nps.technology_innovation IS NOT NULL\\n      OR nps.satisfaction_value_add IS NOT NULL\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type\\n)\\n\\n-- Final result\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ns.total_responses, 0) AS nps_total_responses,\\n    COALESCE(ns.promoters, 0) AS nps_promoters,\\n    COALESCE(ns.neutrals, 0) AS nps_neutrals,\\n    COALESCE(ns.detractors, 0) AS nps_detractors,\\n    COALESCE(ns.nps_score, 0) AS nps_score,\\n    COALESCE(avg_s.total_responses, 0) AS survey_total_responses,\\n    COALESCE(avg_s.avg_program_outreach, 0) AS avg_program_outreach,\\n    COALESCE(avg_s.avg_internal_capacity, 0) AS avg_internal_capacity,\\n    COALESCE(avg_s.avg_confident_leverage, 0) AS avg_confident_leverage,\\n    COALESCE(avg_s.avg_improved_efficiency, 0) AS avg_improved_efficiency,\\n    COALESCE(avg_s.avg_technology_innovation, 0) AS avg_technology_innovation,\\n    COALESCE(avg_s.avg_satisfaction_value_add, 0) AS avg_satisfaction_value_add\\n\\nFROM calendar cal\\nLEFT JOIN nps_scores ns\\n  ON ns.start_date = cal.start_date AND ns.period_type = cal.period_type\\nLEFT JOIN average_scores avg_s\\n  ON avg_s.start_date = cal.start_date AND avg_s.period_type = cal.period_type\\n\\nORDER BY cal.start_date\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_financials\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\nunpivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n        item,\\n        amount\\n    FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_budget_actuals\\\"\\n),\\n\\npivoted_actuals AS (\\n    SELECT\\n        financial_label,\\n        product_type,\\n\\n        MAX(CASE WHEN item = 'Actual Revenue' THEN amount END) AS actual_revenue,\\n        MAX(CASE WHEN item = 'Target Revenue' THEN amount END) AS target_revenue,\\n        MAX(CASE WHEN item = 'Actual Expenses' THEN amount END) AS actual_expenses\\n\\n    FROM unpivoted_actuals\\n    GROUP BY financial_label, product_type\\n)\\n\\nSELECT\\n    c.start_date,\\n    c.end_date,\\n    c.financial_label,\\n    c.period_type,\\n    p.product_type,\\n    c.sort_order,\\n    p.actual_revenue,\\n    p.target_revenue,\\n    p.actual_expenses,\\n    p.actual_revenue/NULLIF(p.actual_expenses, 0) AS sustainability,\\n    p.actual_revenue/NULLIF(p.target_revenue,0) as target_revenue_met\\nFROM pivoted_actuals p\\nJOIN calendar c\\n    ON p.financial_label = c.financial_label\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"campaign_metrics_per_newsletter\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nreports as (\\n    select * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_reports\\\"\\n)\\n\\nselect\\n    c.campaign_name,\\n    c.subject,\\n    c.org,\\n    c.sent_time,\\n    r.emails_sent,\\n    r.delivered,\\n    r.opens,\\n    r.clicks,\\n    r.open_rate,\\n    r.delivery_rate,\\n    r.clickthrough_rate\\nfrom campaigns c\\nleft join reports r on c.campaign_key = r.campaign_id\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * \\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_opportunities\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *,\\n       daterange(expected_start_date, expected_end_date, '[]') as project_duration\\n from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"newsletter_contact_summary\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.4, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith campaigns as (\\n    select campaign_key, org from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n),\\nrecipients as (\\n    select contactid, sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaign_recipients\\\"\\n),\\ncombined as (\\n    select\\n        c.org,\\n        r.contactid,\\n        min(r.sent_time) as first_sent,\\n        max(r.sent_time) as last_sent,\\n        count(*) as num_campaigns\\n    from recipients r\\n    join campaigns c on r.sent_time in (\\n        select sent_time from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_campaigns\\\"\\n    )\\n    group by c.org, r.contactid\\n)\\n\\nselect\\n    org,\\n    count(distinct contactid) as total_contacts_reached,\\n    sum(num_campaigns) as total_messages_sent\\nfrom combined\\ngroup by org\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"monthly_digest\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n        *, CASE WHEN report_date = MAX(report_date) OVER (PARTITION BY project) THEN 'Yes' ELSE 'No' END AS is_most_recent\\n    FROM\\n        \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_monthly_digest\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"mailing_lists\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_mailing_lists\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"resource_allocation_metrics\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith monthly_allocation as (\\n    select\\n        month_start_date,\\n        month_end_date,\\n        department,\\n        employee_name,\\n        total_hours as utilized_hours, -- total_hours is the utilized hours\\n        balance_hours,\\n        total_capacity,\\n        -- Calculate utilization percentage based on total capacity\\n        round((total_hours / nullif(total_capacity, 0)) * 100, 2) as utilization_percentage\\n    from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\\n),\\n\\ndepartment_summary as (\\n    select\\n        month_start_date,\\n        department,\\n        count(distinct employee_name) as employee_count,\\n        sum(utilized_hours) as total_utilized_hours,\\n        sum(balance_hours) as total_balance_hours,\\n        sum(total_capacity) as total_capacity,\\n        round(avg(utilization_percentage), 2) as avg_utilization_percentage\\n    from monthly_allocation\\n    group by month_start_date, department\\n)\\n\\nselect\\n    ma.*,\\n    ds.employee_count as dept_employee_count,\\n    ds.total_utilized_hours as dept_utilized_hours,\\n    ds.total_balance_hours as dept_balance_hours,\\n    ds.total_capacity as dept_total_capacity,\\n    ds.avg_utilization_percentage as dept_avg_utilization\\nfrom monthly_allocation ma\\nleft join department_summary ds \\n    on ma.month_start_date = ds.month_start_date \\n    and ma.department = ds.department\\norder by \\n    ma.month_start_date desc,\\n    ma.department,\\n    ma.employee_name\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_task_hierarchy\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith recursive task_cte as (\\n  -- Anchor: start with tasks that have no parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    array[t.subject] as path\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  where t.parent_task is null\\n\\n  union all\\n\\n  -- Recursive part: join children to their parent\\n  select\\n    t.name,\\n    t.subject,\\n    t.status,\\n    t.description,\\n    t.predecessor,\\n    t.successor,\\n    p.project_name,\\n    t.parent_task,\\n    cte.path || t.subject\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_projects\\\" p on t.project = p.name\\n  join task_cte cte on t.parent_task = cte.name\\n)\\n\\nselect * from task_cte\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_resource_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        hours,\\n        month,\\n        product,\\n        project,\\n        project_name,\\n        activity,\\n        owner,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        parent,\\n        docstatus,\\n        modified_by\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabHours_Allocation_Table\\\"\\n-- skip all cancelled items\\n    where docstatus != 2 \\n\\n)\\n\\nselect \\n  s.*, \\n  r.total_capacity, \\n  r.month_start_date,\\n  r.employee_name \\nfrom source as s\\nleft join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\" as r\\n  on s.parent = r.allocation_id\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"resource_time_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_time_allocation\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_mailing_lists\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    sno,\\n    date,\\n    zuid as zoho_id,\\n    owner,\\n    issmart as is_smart,\\n    listdgs as list_dgs,\\n    listkey as list_key,\\n    sentcnt as sent_count,\\n    editable,\\n    listname as list_name,\\n    deletable,\\n    is_public,\\n    listunino as list_unique_id_no,\\n    lockstatus as lock_status,\\n    servicetype as service_type,\\n\\n    -- Raw timestamp fields\\n    created_time,\\n    created_time_gmt,\\n    updated_time_gmt,\\n\\n    -- Converted to timestamp\\n    TO_TIMESTAMP(cast(created_time as bigint) / 1000) as created_time_ts,\\n    TO_TIMESTAMP(cast(created_time_gmt as bigint) / 1000) as created_time_gmt_ts,\\n    TO_TIMESTAMP(cast(updated_time_gmt as bigint) / 1000) as updated_time_gmt_ts,\\n\\n    noofcontacts as no_of_contacts,\\n    noofunsubcnt as no_of_subscribers_cnt,\\n    noofbouncecnt as no_of_bounce_cnt,\\n    list_created_date,\\n    list_created_time,\\n    list_campaigns_count\\n\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"mailing_lists\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_campaign_reports\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    campaign_id,\\n    cast(emails_sent_count as integer) as emails_sent,\\n    cast(opens_count as integer) as opens,\\n    cast(delivered_count as integer) as delivered,\\n    cast(unique_clicks_count as integer) as clicks,\\n    cast(open_percent as float) as open_rate,\\n    cast(delivered_percent as float) as delivery_rate,\\n    cast(unique_clicked_percent as float) as clickthrough_rate\\nFROM \\\"tech4dev\\\".\\\"staging_zoho\\\".\\\"campaign_reports\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"sales_invoice\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect *, EXTRACT(DAY FROM (now() - due_date))::int as invoice_ageing from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_sales_invoice\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_projects\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Projects started per period and product_type\\nprojects_started AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_started\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_start_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, p.product_type\\n),\\n\\n-- Projects ongoing per period and product_type\\nprojects_ongoing AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ongoing\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.project_duration && daterange(cal.start_date, cal.end_date, '[]')\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n),\\n\\n-- Projects ended per period and product_type\\nprojects_ended AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        p.product_type,\\n        COUNT(*) AS projects_ended\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"production\\\".\\\"projects\\\" p\\n      ON p.expected_end_date BETWEEN cal.start_date AND cal.end_date\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type,p.product_type\\n)\\n\\n-- Final union of metrics\\nSELECT\\n    cal.start_date,\\n    cal.end_date,\\n    cal.period_type,\\n    cal.financial_label,\\n    cal.sort_order,\\n    COALESCE(ps.product_type, po.product_type, pe.product_type) AS product_type,\\n    COALESCE(ps.projects_started, 0) AS projects_started,\\n    COALESCE(po.projects_ongoing, 0) AS projects_ongoing,\\n    COALESCE(pe.projects_ended, 0) AS projects_ended\\n\\nFROM calendar cal\\nLEFT JOIN projects_started ps\\n  ON ps.start_date = cal.start_date AND ps.period_type = cal.period_type\\nLEFT JOIN projects_ongoing po\\n  ON po.start_date = cal.start_date AND po.period_type = cal.period_type AND po.product_type = ps.product_type\\nLEFT JOIN projects_ended pe\\n  ON pe.start_date = cal.start_date AND pe.period_type = cal.period_type AND pe.product_type = ps.product_type\\n\\nORDER BY cal.start_date, product_type\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"resource_allocation\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect * from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_resource_allocation\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"task_hierarchy\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.5, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith leaf_completion as (\\n  select\\n    t.name,\\n    case when t.status = 'Completed' then 100.0 else 0.0 end as leaf_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\n  where not exists (\\n    select 1 from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_tasks\\\" t2\\n    where t2.parent_task = t.name\\n  )\\n),\\n\\nancestor_completion as (\\n  select\\n    ancestor.name as task_name,\\n    avg(lc.leaf_completion) as avg_completion\\n  from \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as ancestor\\n  join \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" as descendant\\n    on descendant.path[1:array_length(ancestor.path,1)] = ancestor.path\\n  join leaf_completion lc on descendant.name = lc.name\\n  group by ancestor.name\\n)\\n\\nselect\\n  case when array_length(t.path, 1) >= 1 then t.path[1] end as \\\"level_1\\\",\\n  case when array_length(t.path, 1) >= 2 then t.path[2] end as \\\"level_2\\\",\\n  t.status,\\n  t.predecessor,\\n  t.successor,\\n  t.project_name,\\n  t.description,\\n  substring(description, 'https?:\\\\/\\\\/[^\\\\s<>\\\"]+') AS extracted_link,\\n  round(coalesce(ac.avg_completion, \\n         case when t.status = 'Completed' then 100.0 else 0.0 end), 2) as \\\"completion_float\\\"\\nfrom \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_task_hierarchy\\\" t\\nleft join ancestor_completion ac on t.name = ac.task_name\\nwhere array_length(t.path, 1) <= 2\\norder by t.path\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_sales_invoice\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect product_type, name,customer,status, due_date, base_grand_total as outstanding_amount from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabSales_Invoice\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_tasks\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.2, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nselect\\n    name,\\n    lft as predecessor,\\n    rgt as successor,\\n    subject,\\n    status,\\n    project,\\n    description,\\n    parent_task\\nfrom \\\"tech4dev\\\".\\\"staging\\\".\\\"tabTask\\\"\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"int_resource_time_allocation\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nwith source as (\\n    select\\n        idx,\\n        name,\\n        employee,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN modified IS NULL OR TRIM(modified::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(modified::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(modified::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(modified)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM modified::DATE) BETWEEN 1900 AND 2050 \\n                THEN modified::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(modified::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(modified::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(modified::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as modified_date,\\n        _comments,\\n        _liked_by,\\n        docstatus,\\n        _user_tags,\\n        department,\\n        modified_by,\\n        total_hours::numeric as total_hours,\\n        amended_from,\\n        balance_hours::numeric as balance_hours,\\n        employee_name,\\n        total_capacity::numeric as total_capacity,\\n        \\n-- We have data coming from several google sheets and from commcare. below macro makes sure every data column, no matter\\n-- which table it is in or which source it is coming from is in the same appropriate format. \\n-- Sometimes in google sheets, in one row someone enters 2024/10/05 and elsewhere someone enters 10-5-2024 it will standardize it\\n-- If the extracted year is before 1900 or after 2050, it is assumed to be incorrect and returns NULL.\\nCAST(\\n    CASE\\n        -- Ensure NULL and empty values are handled safely\\n        WHEN month_start_date IS NULL OR TRIM(month_start_date::TEXT) = '' THEN NULL::DATE\\n\\n        -- If already a DATE, return as is (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) = 'date' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n            \\n        -- Handle strict DD/MM/YYYY format (e.g., 01/09/2024 or 9/9/2024)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^([0-2]?[0-9]|3[01])/([0]?[1-9]|1[0-2])/[1-2]\\\\d{3}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/MM/YY (e.g., 05/08/24 \\u2192 2024-08-05) and DD/M/YY (e.g., 15/5/24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD-MM-YY (e.g., 05-08-24 \\u2192 2024-08-05) and DD-M-YY (e.g., 15-5-24 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle ISO 8601 format (e.g., 2024-02-05T08:52:24.859000Z)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$' THEN\\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')) BETWEEN 1900 AND 2050 \\n                THEN TO_TIMESTAMP(TRIM(month_start_date::TEXT), 'YYYY-MM-DD\\\"T\\\"HH24:MI:SS.US')::DATE\\n                ELSE NULL \\n            END\\n\\n        -- If TIMESTAMP, convert to DATE (but check valid range)\\n        WHEN LOWER(pg_typeof(month_start_date)::TEXT) LIKE 'timestamp%' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM month_start_date::DATE) BETWEEN 1900 AND 2050 \\n                THEN month_start_date::DATE\\n                ELSE NULL \\n            END\\n        \\n\\n        -- Handle DD-M-YYYY (e.g., 15-5-2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])-(0?[1-9]|1[0-2])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD-FMMM-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle DD/M/YYYY (e.g., 15/5/2024 \\u2192 2024-05-15)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|[12][0-9]|3[01])/(0?[1-9]|1[0-2])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMDD/FMMM/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY-MM-DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY-FMMM-FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle YYYY/MM/DD \\n        WHEN TRIM(month_start_date::TEXT) ~ '^\\\\d{4}/(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'YYYY/FMMM/FMDD') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YYYY \\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{4}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY')) BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YYYY') \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM/DD/YY (e.g., 08/05/24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])/(0?[1-9]|[12][0-9]|3[01])/\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM/FMDD/YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- Handle MM-DD-YY (e.g., 08-05-24 \\u2192 2024-08-05)\\n        WHEN TRIM(month_start_date::TEXT) ~ '^(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])-\\\\d{2}$' THEN \\n            CASE \\n                WHEN EXTRACT(YEAR FROM TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years') BETWEEN 1900 AND 2050 \\n                THEN TO_DATE(TRIM(month_start_date::TEXT), 'FMMM-FMDD-YY') + INTERVAL '2000 years' \\n                ELSE NULL \\n            END\\n\\n        -- If no match, return NULL\\n        ELSE NULL::DATE\\n    END\\nAS DATE)\\n as month_start_date\\n    from \\\"tech4dev\\\".\\\"staging\\\".\\\"tabResource_Time_Allocation\\\"\\n)\\n\\nselect \\n    idx,\\n    name as allocation_id,\\n    employee,\\n    employee_name,\\n    department,\\n    total_hours,\\n    balance_hours,\\n    total_capacity,\\n    month_start_date,\\n    modified_date,\\n    -- Extract month and year from month_start_date for grouping purposes\\n    EXTRACT(MONTH FROM month_start_date) as month_number,\\n    EXTRACT(YEAR FROM month_start_date) as year_number,\\n    -- First day of the next month for date range queries\\n    (month_start_date + INTERVAL '1 MONTH')::DATE as month_end_date\\nfrom source\\nwhere month_start_date is not null  -- Ensure we have valid dates\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"name\": \"kpi_opportunities\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH calendar AS (\\n    SELECT * FROM \\\"tech4dev\\\".\\\"production\\\".\\\"calendar\\\"\\n),\\n\\n-- Opportunities created per period and product_type\\nopportunities_created AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_created\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON o.creation::date BETWEEN cal.start_date AND cal.end_date\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Opportunities converted per period and product_type\\nopportunities_converted AS (\\n    SELECT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        ptt.product_type,\\n        COUNT(*) AS opportunities_converted\\n    FROM calendar cal\\n    JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabOpportunity\\\" o\\n      ON COALESCE(o.custom_conversion_date, o.modified)::date BETWEEN cal.start_date AND cal.end_date\\n      AND o.status = 'Converted'\\n    LEFT JOIN \\\"tech4dev\\\".\\\"staging\\\".\\\"tabProduct_Type_Table\\\" ptt\\n      ON ptt.parent = o.name\\n    GROUP BY cal.start_date, cal.end_date, cal.period_type, ptt.product_type\\n),\\n\\n-- Get all unique combinations of calendar periods and product types\\nperiod_product_combinations AS (\\n    SELECT DISTINCT\\n        cal.start_date,\\n        cal.end_date,\\n        cal.period_type,\\n        cal.financial_label,\\n        cal.sort_order,\\n        COALESCE(pt.product_type, 'Unknown') AS product_type\\n    FROM calendar cal\\n    CROSS JOIN (\\n        SELECT DISTINCT product_type FROM opportunities_created\\n        UNION\\n        SELECT DISTINCT product_type FROM opportunities_converted\\n        UNION\\n        SELECT 'Unknown' AS product_type\\n    ) pt\\n)\\n\\n-- Final result\\nSELECT\\n    ppc.start_date,\\n    ppc.end_date,\\n    ppc.period_type,\\n    ppc.financial_label,\\n    ppc.sort_order,\\n    ppc.product_type,\\n    COALESCE(oc.opportunities_created, 0) AS opportunities_created,\\n    COALESCE(ocv.opportunities_converted, 0) AS opportunities_converted\\n\\nFROM period_product_combinations ppc\\nLEFT JOIN opportunities_created oc\\n  ON oc.start_date = ppc.start_date \\n  AND oc.period_type = ppc.period_type \\n  AND COALESCE(oc.product_type, 'Unknown') = ppc.product_type\\nLEFT JOIN opportunities_converted ocv\\n  ON ocv.start_date = ppc.start_date \\n  AND ocv.period_type = ppc.period_type \\n  AND COALESCE(ocv.product_type, 'Unknown') = ppc.product_type\\n\\nORDER BY ppc.start_date, ppc.product_type\", \"generated_at\": \"2026-02-09 02:37:06\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_consulting_tracker\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    TO_DATE(start_date, 'DD/MM/YYYY')::DATE AS start_date,\\n    TO_DATE(end_date, 'DD/MM/YYYY')::DATE AS end_date,\\n    consultant,\\n    ngo,\\n    project_program,\\n    category,\\n    dashboard,\\n    description,\\n    hours_spent::numeric,\\n    billing_status,\\n    num_charts_made::integer,\\n    attendees,\\n    json_blob\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"consulting_time_tracker\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"linkedin_stats\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nWITH\\norgs AS (\\n  SELECT * FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_org_lookup\\\"\\n),\\nshares AS (\\n  SELECT\\n    organizational_entity AS urn,\\n    CAST(like_count AS INTEGER) AS like_count,\\n    CAST(click_count AS INTEGER) AS click_count,\\n    CAST(engagement AS FLOAT) AS engagement,\\n    CAST(share_count AS INTEGER) AS share_count,\\n    CAST(comment_count AS INTEGER) AS comment_count,\\n    CAST(impression_count AS INTEGER) AS impression_count,\\n    CAST(share_mentions_count AS INTEGER) AS share_mentions_count,\\n    CAST(comment_mentions_count AS INTEGER) AS comment_mentions_count,\\n    CAST(unique_impressions_count AS INTEGER) AS unique_impressions_count\\n  FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_share_statistics\\\"\\n),\\nfollower_count AS (\\n  SELECT total_followers FROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_linkedin_follower_count\\\"\\n  LIMIT 1\\n)\\n\\nSELECT\\n  o.id,\\n  o.org_name,\\n  o.logo_url,\\n  o.website_url,\\n  o.localized_name,\\n  o.vanity_name,\\n  o.organization_type,\\n  o.primary_organization_type,\\n  o.staff_count_range,\\n  o.description,\\n\\n  s.like_count,\\n  s.click_count,\\n  s.engagement,\\n  s.share_count,\\n  s.comment_count,\\n  s.impression_count,\\n  s.unique_impressions_count,\\n  s.share_mentions_count,\\n  s.comment_mentions_count,\\n\\n  f.total_followers\\n\\nFROM orgs o\\nLEFT JOIN shares s ON o.urn = s.urn\\nCROSS JOIN follower_count f\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_follower_count\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"firstDegreeSize\\\" AS total_followers\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"total_follower_count\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_org_lookup\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  id,\\n  \\\"_URN\\\" AS urn,\\n  name::jsonb -> 'localized' ->> 'en_US' AS org_name,\\n  \\\"logoV2\\\"::jsonb ->> 'original' AS logo_url,\\n  website::jsonb -> 'localized' ->> 'en_US' AS website_url,\\n  description::jsonb -> 'localized' ->> 'en_US' AS description,\\n  \\\"localizedName\\\" as localized_name,\\n  \\\"staffCountRange\\\" as staff_count_range,\\n  \\\"vanityName\\\" as vanity_name,\\n  \\\"organizationType\\\" as organization_type,\\n  \\\"primaryOrganizationType\\\" as primary_organization_type\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"organization_lookup\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_follower_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  jsonb_array_elements(\\\"followerCountsByFunction\\\"::jsonb) AS function_stats,\\n  jsonb_array_elements(\\\"followerCountsByIndustry\\\"::jsonb) AS industry_stats,\\n  jsonb_array_elements(\\\"followerCountsBySeniority\\\"::jsonb) AS seniority_stats,\\n  jsonb_array_elements(\\\"followerCountsByAssociationType\\\"::jsonb) AS association_type_stats,\\n  jsonb_array_elements(\\\"followerCountsByStaffCountRange\\\"::jsonb) AS staff_count_stats\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"follower_statistics\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_support_issues\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n    support_issue_id,\\n    TO_DATE(reporting_day, 'DD/MM/YYYY')::DATE AS reporting_day,\\n    TO_DATE(resolution_day, 'DD/MM/YYYY')::DATE AS resolution_day,\\n    raised_by,\\n    assigned_to\\n    ngo,\\n    status,\\n    description,\\n    hours_spent::numeric\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"support_issues_tracker\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"int_linkedin_share_statistics\", \"schema\": \"intermediate\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\nSELECT\\n  \\\"organizationalEntity\\\" as organizational_entity,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'likeCount' AS like_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'clickCount' AS click_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'engagement' AS engagement,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareCount' AS share_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentCount' AS comment_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'impressionCount' AS impression_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'shareMentionsCount' AS share_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'commentMentionsCount' AS comment_mentions_count,\\n  \\\"totalShareStatistics\\\"::jsonb ->> 'uniqueImpressionsCount' AS unique_impressions_count\\nFROM \\\"tech4dev\\\".\\\"staging_dalgo\\\".\\\"share_statistics\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"consulting_tracker\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.3, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_consulting_tracker\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"name\": \"support_issues\", \"schema\": \"production\", \"status\": \"success\", \"execution_time\": 0.1, \"full_refresh\": false, \"materialization\": \"table\", \"compiled_code\": \"\\n\\n\\nSELECT \\n* \\nFROM \\\"tech4dev\\\".\\\"intermediate\\\".\\\"int_support_issues\\\"\", \"generated_at\": \"2026-02-09 20:36:48\"}]", "name": "JinjaLogInfo", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.935143Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.967148Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.4071302, "process_in_blocks": "0", "process_kernel_time": 0.201981, "process_mem_max_rss": "160308", "process_out_blocks": "9328", "process_user_time": 6.623195}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 6.4071302, \"process_user_time\": 6.623195, \"process_kernel_time\": 0.201981, \"process_mem_max_rss\": \"160308\", \"process_out_blocks\": \"9328\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.976529Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:21.979699Z", "elapsed": 6.410522, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:21.979699 after 6.41 seconds", "name": "CommandCompleted", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.979856Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.980529Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151f6f60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d152ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf31522584560>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151f6f60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf3151d152ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xf31522584560>]}", "name": "SendingEvent", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.984318Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "91e826c8-8b70-4d60-b956-2567343cab08", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1823100, "thread": "MainThread", "ts": "2026-02-10T00:01:21.984995Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b81c7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b7e9b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b7e9b6e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b81c7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b7e9b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b7e9b6e0>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:24.730344Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:24.734140Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_dbt_models_test_coverage\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'profiles_dir': 'elementary_profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_dbt_models_test_coverage\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'introspect': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:24.735077Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b97df3e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b97df3e0>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:24.992471Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b89812e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b89812e0>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.055235Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.056429Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.173735Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.404653Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.405429Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b6f861b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b6f861b0>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.471453Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b67c8e00>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b67c8e00>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.658602Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.659453Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b684b560>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68ecc9c8-ca26-482e-8e1e-fcc04131a4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b684b560>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.661115Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.662139Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.662786Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.663345Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.663902Z"}}
{"data": {"elapsed": 0.028421829, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "SQL status: BEGIN in 0.028 seconds", "name": "SQLQueryStatus", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.692419Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.693237Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.693850Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.694451Z"}}
{"data": {"elapsed": 0.00055717, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.695679Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.715775Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.762268Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.763238Z"}}
{"data": {"elapsed": 0.00074646797, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.764829Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.765750Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.766512Z"}}
{"data": {"elapsed": 0.004568306, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "SQL status: SELECT 28 in 0.005 seconds", "name": "SQLQueryStatus", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.772287Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, job_run_results, monitors_runs, metrics_anomaly_score, model_run_results, snapshot_run_results, dbt_artifacts_hashes, alerts_dbt_models, alerts_dbt_source_freshness, alerts_anomaly_detection, alerts_dbt_tests, anomaly_threshold_sensitivity, alerts_schema_changes", "name": "ListRelations", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.781381Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.789419Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n            with dbt_tests as (\n                select\n                    parent_model_unique_id,\n                    test_column_name\n                from \"tech4dev\".\"elementary\".\"dbt_tests\"\n            )\n\n            select \n                parent_model_unique_id as model_unique_id,\n                SUM(\n                    case \n                        when test_column_name is not null then 1\n                        else 0\n                        end\n                ) as column_tests,\n                 SUM(\n                    case\n                        when test_column_name is null then 1\n                        else 0\n                        end \n                )as table_tests\n            from dbt_tests\n            group by parent_model_unique_id\n        \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n            with dbt_tests as (\n                select\n                    parent_model_unique_id,\n                    test_column_name\n                from \"tech4dev\".\"elementary\".\"dbt_tests\"\n            )\n\n            select \n                parent_model_unique_id as model_unique_id,\n                SUM(\n                    case \n                        when test_column_name is not null then 1\n                        else 0\n                        end\n                ) as column_tests,\n                 SUM(\n                    case\n                        when test_column_name is null then 1\n                        else 0\n                        end \n                )as table_tests\n            from dbt_tests\n            group by parent_model_unique_id\n        \n  ", "name": "SQLQuery", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.790160Z"}}
{"data": {"elapsed": 0.001462996, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "SQL status: SELECT 0 in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.792297Z"}}
{"data": {"msg": "Elementary: []"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "info", "msg": "Elementary: []", "name": "JinjaLogInfo", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.800813Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.801555Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.803037Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.1326905, "process_in_blocks": "0", "process_kernel_time": 0.157347, "process_mem_max_rss": "162996", "process_out_blocks": "3872", "process_user_time": 2.260357}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 1.1326905, \"process_user_time\": 2.260357, \"process_kernel_time\": 0.157347, \"process_mem_max_rss\": \"162996\", \"process_out_blocks\": \"3872\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.812266Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:25.813088Z", "elapsed": 1.1337153, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:25.813088 after 1.13 seconds", "name": "CommandCompleted", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.813213Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.813916Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b7d7ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b67c9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b70811c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b7d7ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b67c9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xeb18b70811c0>]}", "name": "SendingEvent", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.814515Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "68ecc9c8-ca26-482e-8e1e-fcc04131a4c3", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1823179, "thread": "MainThread", "ts": "2026-02-10T00:01:25.815208Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0c958170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0f260470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0d6e94f0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0c958170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0f260470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0d6e94f0>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.360945Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.364616Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_nodes_depends_on_nodes\", \"macro_args\": {\"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'profiles_dir': 'elementary_profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_nodes_depends_on_nodes\", \"macro_args\": {\"exclude_elementary\": true}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.365535Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0bc3c620>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0bc3c620>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.628035Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0c8eaba0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0c8eaba0>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.691658Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.692872Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.792392Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.951781Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.952642Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.953326Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0d386ed0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0d386ed0>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:28.954015Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.018204Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0b2d05c0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0b2d05c0>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.019128Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0b1a0680>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0b1a0680>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.339154Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0ba5d3d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0ba5d3d0>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.515648Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.516483Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0ba25730>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6f404d-b157-4821-95e0-d7faed01f67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0ba25730>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.517184Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.518033Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.518663Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.519236Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.519798Z"}}
{"data": {"elapsed": 0.02966245, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.549549Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.550344Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.550965Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.551535Z"}}
{"data": {"elapsed": 0.0006412461, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.552787Z"}}
{"data": {"conn_name": "macro_log_macro_results", "database": "tech4dev", "schema": "elementary"}, "info": {"category": "", "code": "E013", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On \"macro_log_macro_results\": cache miss for schema \"tech4dev.elementary\", this is inefficient", "name": "CacheMiss", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.571367Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.615882Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.617608Z"}}
{"data": {"elapsed": 0.0007531049, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.619606Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.620393Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\nselect\n      'tech4dev' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'elementary'\n    union all\n    select\n      'tech4dev' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'elementary'\n  ", "name": "SQLQuery", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.621360Z"}}
{"data": {"elapsed": 0.004377589, "query_id": "", "status": "SELECT 28"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "SQL status: SELECT 28 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.626582Z"}}
{"data": {"database": "tech4dev", "relations": [{"database": "tech4dev", "identifier": "dbt_invocations", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_seeds", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_exposures", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_snapshots", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_source_freshness_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "elementary_test_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_sources", "schema": "elementary"}, {"database": "tech4dev", "identifier": "data_monitoring_metrics", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_columns", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "schema_columns_snapshot", "schema": "elementary"}, {"database": "tech4dev", "identifier": "test_result_rows", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metadata", "schema": "elementary"}, {"database": "tech4dev", "identifier": "job_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "monitors_runs", "schema": "elementary"}, {"database": "tech4dev", "identifier": "metrics_anomaly_score", "schema": "elementary"}, {"database": "tech4dev", "identifier": "model_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "snapshot_run_results", "schema": "elementary"}, {"database": "tech4dev", "identifier": "dbt_artifacts_hashes", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_models", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_source_freshness", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_anomaly_detection", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_dbt_tests", "schema": "elementary"}, {"database": "tech4dev", "identifier": "anomaly_threshold_sensitivity", "schema": "elementary"}, {"database": "tech4dev", "identifier": "alerts_schema_changes", "schema": "elementary"}], "schema": "elementary"}, "info": {"category": "", "code": "E014", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "While listing relations in database=tech4dev, schema=elementary, found: dbt_invocations, dbt_run_results, dbt_seeds, dbt_exposures, dbt_metrics, dbt_snapshots, dbt_tests, dbt_source_freshness_results, elementary_test_results, dbt_sources, data_monitoring_metrics, dbt_columns, dbt_models, schema_columns_snapshot, test_result_rows, metadata, job_run_results, monitors_runs, metrics_anomaly_score, model_run_results, snapshot_run_results, dbt_artifacts_hashes, alerts_dbt_models, alerts_dbt_source_freshness, alerts_anomaly_detection, alerts_dbt_tests, anomaly_threshold_sensitivity, alerts_schema_changes", "name": "ListRelations", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.635977Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.643724Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        select\n            unique_id,\n            depends_on_nodes,\n            materialization,\n            'model' as type\n        from \"tech4dev\".\"elementary\".\"dbt_models\"\n        \n            where package_name != 'elementary'\n        \n        union all\n        select\n            unique_id,\n            null as depends_on_nodes,\n            null as materialization,\n            'source' as type\n        from \"tech4dev\".\"elementary\".\"dbt_sources\"\n        union all\n        select\n            unique_id,\n            depends_on_nodes,\n            null as materialization,\n            'exposure' as type\n        from \"tech4dev\".\"elementary\".\"dbt_exposures\"\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n        select\n            unique_id,\n            depends_on_nodes,\n            materialization,\n            'model' as type\n        from \"tech4dev\".\"elementary\".\"dbt_models\"\n        \n            where package_name != 'elementary'\n        \n        union all\n        select\n            unique_id,\n            null as depends_on_nodes,\n            null as materialization,\n            'source' as type\n        from \"tech4dev\".\"elementary\".\"dbt_sources\"\n        union all\n        select\n            unique_id,\n            depends_on_nodes,\n            null as materialization,\n            'exposure' as type\n        from \"tech4dev\".\"elementary\".\"dbt_exposures\"\n    \n  ", "name": "SQLQuery", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.644397Z"}}
{"data": {"elapsed": 0.001824147, "query_id": "", "status": "SELECT 61"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "SQL status: SELECT 61 in 0.002 seconds", "name": "SQLQueryStatus", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.647129Z"}}
{"data": {"msg": "Elementary: [{\"unique_id\": \"model.tech4dev.resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_opportunities\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_reports\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.recent_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_recipients\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabResource_Time_Allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\", \\\"source.tech4dev.erp_next.resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabTask\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabMonthly_Digest\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabEmployee\\\", \\\"source.tech4dev.erp_next.tabFocus_Area_Table\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.follower_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.total_follower_count\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.support_issues_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.consulting_time_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.organization_lookup\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_recipients\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_reports\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"depends_on_nodes\": \"[]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_monthly_digest\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_task_hierarchy\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.int_budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabNPS_Survey\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_support_issues\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_consulting_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_linkedin_follower_count\\\", \\\"model.tech4dev.int_linkedin_org_lookup\\\", \\\"model.tech4dev.int_linkedin_share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabMonthly_Digest\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabFocus_Area_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabEmployee\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabTask\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProject\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabResource_Time_Allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.resource_allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.consulting_time_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.support_issues_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_recipients\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_reports\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.recent_campaigns\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.mailing_lists\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.follower_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.share_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.organization_lookup\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.total_follower_count\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.sales_invoice\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.budget_actuals\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabNPS_Survey\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabCustomer\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabOpportunity\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProduct_Type_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "info", "msg": "Elementary: [{\"unique_id\": \"model.tech4dev.resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_opportunities\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_reports\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.recent_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_zoho.campaign_recipients\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabResource_Time_Allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\", \\\"source.tech4dev.erp_next.resource_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabTask\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabMonthly_Digest\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabEmployee\\\", \\\"source.tech4dev.erp_next.tabFocus_Area_Table\\\", \\\"source.tech4dev.erp_next.tabProject\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.follower_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.total_follower_count\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.support_issues_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.consulting_time_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"depends_on_nodes\": \"[\\\"source.tech4dev.staging_dalgo.organization_lookup\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_recipients\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_campaign_reports\\\", \\\"model.tech4dev.int_campaigns\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_mailing_lists\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"depends_on_nodes\": \"[]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_monthly_digest\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_task_hierarchy\\\", \\\"model.tech4dev.int_tasks\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_resource_time_allocation\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.int_budget_actuals\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"source.tech4dev.erp_next.tabNPS_Survey\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"depends_on_nodes\": \"[\\\"model.tech4dev.calendar\\\", \\\"model.tech4dev.projects\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_support_issues\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_consulting_tracker\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_linkedin_follower_count\\\", \\\"model.tech4dev.int_linkedin_org_lookup\\\", \\\"model.tech4dev.int_linkedin_share_statistics\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"depends_on_nodes\": \"[\\\"source.tech4dev.erp_next.tabOpportunity\\\", \\\"source.tech4dev.erp_next.tabProduct_Type_Table\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"depends_on_nodes\": \"[\\\"model.tech4dev.int_sales_invoice\\\"]\", \"materialization\": \"table\", \"type\": \"model\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabMonthly_Digest\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabFocus_Area_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabEmployee\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabTask\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProject\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabResource_Time_Allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.resource_allocation\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.consulting_time_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.support_issues_tracker\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_recipients\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.campaign_reports\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.recent_campaigns\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_zoho.mailing_lists\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.follower_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.share_statistics\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.organization_lookup\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.staging_dalgo.total_follower_count\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.sales_invoice\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.budget_actuals\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabNPS_Survey\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabCustomer\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabOpportunity\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}, {\"unique_id\": \"source.tech4dev.erp_next.tabProduct_Type_Table\", \"depends_on_nodes\": null, \"materialization\": null, \"type\": \"source\"}]", "name": "JinjaLogInfo", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.660284Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.661781Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.663138Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.3620696, "process_in_blocks": "0", "process_kernel_time": 0.166373, "process_mem_max_rss": "162996", "process_out_blocks": "7560", "process_user_time": 6.454301}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.3620696, \"process_user_time\": 6.454301, \"process_kernel_time\": 0.166373, \"process_mem_max_rss\": \"162996\", \"process_out_blocks\": \"7560\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.672156Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:33.673020Z", "elapsed": 5.363137, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:33.673020 after 5.36 seconds", "name": "CommandCompleted", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.673153Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.673808Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d10a04560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0c998bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0b4ecfe0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d10a04560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0c998bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xef1d0b4ecfe0>]}", "name": "SendingEvent", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.674400Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "ad6f404d-b157-4821-95e0-d7faed01f67c", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1823230, "thread": "MainThread", "ts": "2026-02-10T00:01:33.675044Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd980c9e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd9829bcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd98020f020>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd980c9e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd9829bcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd98020f020>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.261988Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.265668Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocation\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'elementary_profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocation\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.266513Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd981aab440>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd981aab440>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.508251Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd980ae77a0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd980ae77a0>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.572469Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.573658Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.669928Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.821039Z"}}
{"data": {"msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "previous checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "name": "Note", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.821863Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.822414Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97eb422d0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97eb422d0>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:36.823028Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:40.905645Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd983b627e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd983b627e0>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:40.906519Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97ff15250>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97ff15250>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.237565Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97f1c7e30>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97f1c7e30>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.413821Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.414680Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97e924f20>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee024115-a813-4d76-aca7-dc64f2b9fcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97e924f20>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.415724Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.416954Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.417573Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.418182Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.418750Z"}}
{"data": {"elapsed": 0.02961821, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.448458Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.449263Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.449852Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.450399Z"}}
{"data": {"elapsed": 0.0005861501, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.451565Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.500141Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_run_results as (\n      select *\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select unique_id, invocation_id from latest_run_results\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_run_results as (\n      select *\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select unique_id, invocation_id from latest_run_results\n  \n  ", "name": "SQLQuery", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.500945Z"}}
{"data": {"elapsed": 0.12631163, "query_id": "", "status": "SELECT 66"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "SQL status: SELECT 66 in 0.126 seconds", "name": "SQLQueryStatus", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.627970Z"}}
{"data": {"msg": "Elementary: [{\"unique_id\": \"model.elementary.alerts_anomaly_detection\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_dbt_models\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_dbt_source_freshness\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_dbt_tests\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_schema_changes\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.anomaly_threshold_sensitivity\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.data_monitoring_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_artifacts_hashes\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_columns\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_exposures\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_invocations\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_models\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_seeds\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_snapshots\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_source_freshness_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_sources\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_tests\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.elementary_test_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.job_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.metadata\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.metrics_anomaly_score\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.model_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.monitors_runs\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.schema_columns_snapshot\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.snapshot_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.test_result_rows\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "info", "msg": "Elementary: [{\"unique_id\": \"model.elementary.alerts_anomaly_detection\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_dbt_models\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_dbt_source_freshness\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_dbt_tests\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.alerts_schema_changes\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.anomaly_threshold_sensitivity\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.data_monitoring_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_artifacts_hashes\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_columns\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_exposures\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_invocations\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_models\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_seeds\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_snapshots\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_source_freshness_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_sources\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.dbt_tests\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.elementary_test_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.job_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.metadata\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.metrics_anomaly_score\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.model_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.monitors_runs\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.schema_columns_snapshot\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.snapshot_run_results\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.elementary.test_result_rows\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.calendar\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.campaign_metrics_per_newsletter\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_budget_actuals\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_campaign_recipients\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_campaign_reports\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_campaigns\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_consulting_tracker\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_count\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_follower_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_org_lookup\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_linkedin_share_statistics\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.int_task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.int_tasks\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_financials\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_nps_survey\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.kpi_projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.linkedin_stats\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.mailing_lists\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.monthly_digest\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.newsletter_contact_summary\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.opportunities\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.projects\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.resource_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.resource_allocation_metrics\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.resource_time_allocation\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.sales_invoice\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}, {\"unique_id\": \"model.tech4dev.support_issues\", \"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\"}, {\"unique_id\": \"model.tech4dev.task_hierarchy\", \"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\"}]", "name": "JinjaLogInfo", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.639534Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.640861Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.4391847, "process_in_blocks": "0", "process_kernel_time": 0.184884, "process_mem_max_rss": "162996", "process_out_blocks": "7528", "process_user_time": 6.408323}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.4391847, \"process_user_time\": 6.408323, \"process_kernel_time\": 0.184884, \"process_mem_max_rss\": \"162996\", \"process_out_blocks\": \"7528\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.649923Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:41.650717Z", "elapsed": 5.440183, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:41.650717 after 5.44 seconds", "name": "CommandCompleted", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.650842Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.651457Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd9800f0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97f1c7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97ef86a50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd9800f0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97f1c7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfbd97ef86a50>]}", "name": "SendingEvent", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.652074Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "ee024115-a813-4d76-aca7-dc64f2b9fcb2", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1823318, "thread": "MainThread", "ts": "2026-02-10T00:01:41.652706Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e6918470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e780f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e780c6b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e6918470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e780f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e780c6b0>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.169077Z"}}
{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.172673Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocations_data\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default", "log_cache_events": "False", "log_format": "json", "log_path": "/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "elementary_profiles", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/appdata/clientdbts/tech4dev/dbtrepo/edr_target', 'version_check': 'True', 'profiles_dir': 'elementary_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt --log-format json run-operation elementary.log_macro_results --args {\"macro_name\": \"elementary_cli.get_models_latest_invocations_data\", \"macro_args\": {}} --project-dir /home/ddp/dbt/venv/lib/python3.12/site-packages/elementary/monitor/dbt_project --profiles-dir elementary_profiles --target default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}", "name": "MainReportArgs", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.173507Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e7740e00>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e7740e00>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.406751Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e69876b0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e69876b0>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.468413Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.469601Z"}}
{"data": {"checksum": "e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba", "profile": "", "target": "default", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "checksum: e533d941018929e02280f51a907466e07856c1b23549d3b08ff325de027068ba, vars: {}, profile: , target: default, version: 1.8.7", "name": "StateCheckVarsHash", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.553890Z"}}
{"data": {"reason": "profile has changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "info", "msg": "Unable to do partial parsing because profile has changed", "name": "UnableToPartialParse", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.702263Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'partial_parser', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e73470e0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e73470e0>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:44.703127Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:48.681857Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'deprecation', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e5a0e780>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e5a0e780>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:48.682693Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e5734a70>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e5734a70>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.001252Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e59d5df0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e59d5df0>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.171410Z"}}
{"data": {"stat_line": "39 models, 2 operations, 6 data tests, 6 sources, 1393 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "info", "msg": "Found 39 models, 2 operations, 6 data tests, 6 sources, 1393 macros", "name": "FoundStats", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.172272Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e5a0d730>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411f0b86-d955-4810-8e45-033f70f04786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e5a0d730>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.172937Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Acquiring new postgres connection 'macro_log_macro_results'", "name": "NewConnection", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.173788Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.174404Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.174990Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.175533Z"}}
{"data": {"elapsed": 0.029670894, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "SQL status: BEGIN in 0.030 seconds", "name": "SQLQueryStatus", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.205291Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLCommit", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.206096Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.206700Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: COMMIT", "name": "SQLQuery", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.207270Z"}}
{"data": {"elapsed": 0.0005376339, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.208413Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.270301Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: BEGIN", "name": "SQLQuery", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.271067Z"}}
{"data": {"elapsed": 0.00068523304, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.272382Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.273051Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_invocations'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from \"tech4dev\".INFORMATION_SCHEMA.columns\n      where table_name = 'dbt_invocations'\n        \n        and table_schema = 'elementary'\n        \n      order by ordinal_position\n\n  ", "name": "SQLQuery", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.273652Z"}}
{"data": {"elapsed": 0.009467431, "query_id": "", "status": "SELECT 35"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "SQL status: SELECT 35 in 0.009 seconds", "name": "SQLQueryStatus", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.283745Z"}}
{"data": {"conn_name": "macro_log_macro_results", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Using postgres connection \"macro_log_macro_results\"", "name": "ConnectionUsed", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.295030Z"}}
{"data": {"conn_name": "macro_log_macro_results", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_models_invocations as (\n      select distinct invocation_id\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select\n      invocation_id,\n      command,\n      selected,\n      full_refresh,\n      \n        job_url,\n      \n      job_name,\n      job_id,\n      orchestrator\n    from \"tech4dev\".\"elementary\".\"dbt_invocations\" invocations\n    join latest_models_invocations using (invocation_id)\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"elementary\", \"target_name\": \"default\", \"connection_name\": \"macro_log_macro_results\"} */\n\n    \n    with ordered_run_results as (\n      select\n        *,\n        row_number() over (partition by unique_id order by run_results.generated_at desc) as row_number\n      from \"tech4dev\".\"elementary\".\"dbt_run_results\" run_results\n      join \"tech4dev\".\"elementary\".\"dbt_models\" using (unique_id)\n    ),\n\n    latest_models_invocations as (\n      select distinct invocation_id\n      from ordered_run_results\n      where row_number = 1\n    )\n\n    select\n      invocation_id,\n      command,\n      selected,\n      full_refresh,\n      \n        job_url,\n      \n      job_name,\n      job_id,\n      orchestrator\n    from \"tech4dev\".\"elementary\".\"dbt_invocations\" invocations\n    join latest_models_invocations using (invocation_id)\n  \n  ", "name": "SQLQuery", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.295790Z"}}
{"data": {"elapsed": 0.12719296, "query_id": "", "status": "SELECT 2"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "SQL status: SELECT 2 in 0.127 seconds", "name": "SQLQueryStatus", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.423725Z"}}
{"data": {"msg": "Elementary: [{\"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"command\": \"run\", \"selected\": \"[]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}, {\"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"command\": \"run\", \"selected\": \"[\\\"tag:dalgo\\\"]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}]"}, "info": {"category": "", "code": "I062", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "info", "msg": "Elementary: [{\"invocation_id\": \"a3771bb9-5fd5-4d37-8092-9b4b4a6b7b4e\", \"command\": \"run\", \"selected\": \"[]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}, {\"invocation_id\": \"de3055ce-e4fb-4b25-98cf-c7a8e48c41dc\", \"command\": \"run\", \"selected\": \"[\\\"tag:dalgo\\\"]\", \"full_refresh\": false, \"job_url\": null, \"job_name\": null, \"job_id\": null, \"orchestrator\": null}]", "name": "JinjaLogInfo", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.432828Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: ROLLBACK", "name": "Rollback", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.433692Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "On macro_log_macro_results: Close", "name": "ConnectionClosed", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.435021Z"}}
{"data": {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.3238473, "process_in_blocks": "0", "process_kernel_time": 0.154608, "process_mem_max_rss": "162996", "process_out_blocks": "7520", "process_user_time": 6.34798}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Resource report: {\"command_name\": \"run-operation\", \"command_success\": true, \"command_wall_clock_time\": 5.3238473, \"process_user_time\": 6.34798, \"process_kernel_time\": 0.154608, \"process_mem_max_rss\": \"162996\", \"process_out_blocks\": \"7520\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.443701Z"}}
{"data": {"command": "dbt run-operation", "completed_at": "2026-02-10T00:01:49.444480Z", "elapsed": 5.324824, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Command `dbt run-operation` succeeded at 00:01:49.444480 after 5.32 seconds", "name": "CommandCompleted", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.444632Z"}}
{"data": {"conn_name": "macro_log_macro_results"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Connection 'macro_log_macro_results' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.445247Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e780f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e59d7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e7380860>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e780f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e59d7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xe041e7380860>]}", "name": "SendingEvent", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.445837Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "411f0b86-d955-4810-8e45-033f70f04786", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1823399, "thread": "MainThread", "ts": "2026-02-10T00:01:49.446435Z"}}
